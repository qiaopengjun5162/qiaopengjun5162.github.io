+++
title = "Solana å¼€å‘è¿›é˜¶ï¼šåœ¨ Devnet ä¸Šå®ç°é“¾ä¸Šç¨‹åºéƒ¨ç½²ã€è°ƒç”¨ä¸æ›´æ–°"
description = "Solana å¼€å‘è¿›é˜¶ï¼šåœ¨ Devnet ä¸Šå®ç°é“¾ä¸Šç¨‹åºéƒ¨ç½²ã€è°ƒç”¨ä¸æ›´æ–°"
date = 2025-06-15T12:04:54Z
[taxonomies]
categories = ["Solana", "Web3"]
tags = ["Solana", "Web3"]
+++

<!-- more -->

# Solana å¼€å‘è¿›é˜¶ï¼šåœ¨ Devnet ä¸Šå®ç°é“¾ä¸Šç¨‹åºéƒ¨ç½²ã€è°ƒç”¨ä¸æ›´æ–°

Solana ä»¥å…¶é«˜æ€§èƒ½å’Œä½æˆæœ¬çš„ç‰¹æ€§ï¼Œæˆä¸º Web3 å¼€å‘çš„çƒ­é—¨é€‰æ‹©ã€‚æœ¬æ–‡æ˜¯ Solana å¼€å‘ç³»åˆ—çš„å»¶ç»­ï¼ŒåŸºäºå‰ä¸¤ç¯‡ã€Šæ¢ç´¢ Solana SDK å®æˆ˜ï¼šWeb3 å¼€å‘çš„åŒè·¯å¾„ä¸è½»é‡æ¨¡å—åŒ–ã€‹å’Œã€ŠSolana å¼€å‘å®æˆ˜ï¼šRust å®¢æˆ·ç«¯è°ƒç”¨é“¾ä¸Šç¨‹åºå…¨æµç¨‹ã€‹çš„å†…å®¹ï¼Œå¸¦é¢†è¯»è€…è¿ˆå‘æ›´è´´è¿‘ç”Ÿäº§ç¯å¢ƒçš„å®è·µâ€”â€”åœ¨ Solana çš„ Devnet ç½‘ç»œä¸­éƒ¨ç½²ã€è°ƒç”¨å’Œæ›´æ–°é“¾ä¸Šç¨‹åºã€‚é€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹å’Œæ“ä½œæ­¥éª¤ï¼Œæœ¬æ–‡å°†å¸®åŠ©å¼€å‘è€…ä»æœ¬åœ°å¼€å‘è¿‡æ¸¡åˆ° Devnet å®æˆ˜ï¼ŒæŒæ¡ Solana é“¾ä¸Šå¼€å‘çš„å®Œæ•´æµç¨‹ã€‚

ç»§æœ¬åœ°å¼€å‘å®è·µåï¼Œæœ¬æ–‡é€šè¿‡ Solana çš„ Devnet ç½‘ç»œï¼Œæ·±å…¥å±•ç¤ºé“¾ä¸Šç¨‹åºå¼€å‘çš„è¿›é˜¶æµç¨‹ï¼Œæ¶µç›–å¯†é’¥å¯¹ç”Ÿæˆã€ç¨‹åºéƒ¨ç½²ã€å®¢æˆ·ç«¯è°ƒç”¨ã€ç¨‹åºæ›´æ–°åŠæµ‹è¯•ä¼˜åŒ–ã€‚å¼€å‘è€…å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ solana-keygen grind åˆ›å»ºç‰¹å®šå‰ç¼€çš„é’±åŒ…åœ°å€ï¼Œéƒ¨ç½² Rust ç¨‹åºåˆ° Devnetï¼Œåˆ©ç”¨ Rust å®¢æˆ·ç«¯å®ç°é“¾ä¸Šäº¤äº’ï¼Œå¹¶æ›´æ–°ç¨‹åºä»¥æ·»åŠ æ—¥å¿—å’Œäº‹ä»¶åŠŸèƒ½ã€‚æ–‡ç« è¿˜å¯¹æ¯”äº† start_with_context ä¸ startã€ä»¥åŠ process_transaction ä¸ process_transaction_with_metadata çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸ºä¼˜åŒ–æµ‹è¯•æä¾›æŒ‡å¯¼ã€‚ç»“åˆä»£ç ã€å‘½ä»¤è¡Œå’Œ Solana æµè§ˆå™¨éªŒè¯ï¼Œæœ¬æ–‡ä¸ºå¼€å‘è€…æä¾›ä»æœ¬åœ°åˆ° Devnet çš„å®ç”¨è¿›é˜¶æŒ‡å—ã€‚

## å®æ“

### ç”ŸæˆæŒ‡å®š**Solana å¯†é’¥å¯¹**

ä½¿ç”¨ `solana-keygen grind` ç”Ÿæˆä¸€ä¸ªä»¥æŒ‡å®šå‰ç¼€ `SS` å¼€å¤´çš„ Solana é’±åŒ…åœ°å€ï¼Œå¹¶å°†ç§é’¥ä¿å­˜åˆ°å½“å‰ç›®å½•çš„ `.json` æ–‡ä»¶ä¸­ã€‚

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 10.6s 
âœ mkdir keys    

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ cd keys     

solana-sandbox/sol-program/keys on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ solana-keygen grind --starts-with SS:1 
Searching with 12 threads for:
        1 pubkey that starts with 'SS' and ends with ''
Wrote keypair to SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN.json
```

### æŸ¥çœ‹ç›®å½•ç»“æ„

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ tree . -L 6 -I "coverage_report|lib|.vscode|out|test-ledger|target|node_modules"
.
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ examples
â”‚   â””â”€â”€ client.rs
â”œâ”€â”€ keys
â”‚   â””â”€â”€ SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN.json
â””â”€â”€ src
    â”œâ”€â”€ lib.rs
    â””â”€â”€ lib2.rs

4 directories, 6 files
```

### lib.rs æ–‡ä»¶

```rust
#![allow(unexpected_cfgs)]

use solana_account_info::AccountInfo;
use solana_msg::msg;
use solana_program_entrypoint::entrypoint;
use solana_program_error::ProgramResult;
use solana_pubkey::Pubkey;

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, world!");
    Ok(())
}

#[cfg(test)]
mod test {
    use solana_program_test::*;
    use solana_sdk::{
        instruction::Instruction, pubkey::Pubkey, signature::Signer, transaction::Transaction,
    };

    #[tokio::test]
    async fn test_sol_program() {
        let program_id = Pubkey::new_unique();
        let mut program_test = ProgramTest::default();
        program_test.add_program("sol_program", program_id, None);
        let (banks_client, payer, recent_blockhash) = program_test.start().await;
        // Create instruction
        let instruction = Instruction {
            program_id,
            accounts: vec![],
            data: vec![],
        };
        // Create transaction with instruction
        let mut transaction = Transaction::new_with_payer(&[instruction], Some(&payer.pubkey()));

        // Sign transaction
        transaction.sign(&[&payer], recent_blockhash);

        let transaction_result = banks_client.process_transaction(transaction).await;
        assert!(transaction_result.is_ok());
    }
}
```

### éƒ¨ç½²ç¨‹åº

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ solana config get                                                                                                               
Config File: /Users/qiaopengjun/.config/solana/cli/config.yml
RPC URL: http://localhost:8899 
WebSocket URL: ws://localhost:8900/ (computed)
Keypair Path: /Users/qiaopengjun/.config/solana/id.json 
Commitment: confirmed 

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ solana config set -ud
Config File: /Users/qiaopengjun/.config/solana/cli/config.yml
RPC URL: https://api.devnet.solana.com 
WebSocket URL: wss://api.devnet.solana.com/ (computed)
Keypair Path: /Users/qiaopengjun/.config/solana/id.json 
Commitment: confirmed 

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ cargo build-sbf                                            
    Updating crates.io index
  Downloaded dotenvy v0.15.7
  Downloaded 1 crate (20.3 KB) in 0.47s
   Compiling dotenvy v0.15.7
   Compiling sol-program v0.1.0 (/Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program)
    Finished `release` profile [optimized] target(s) in 2.44s

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 3.6s 
âœ cargo test-sbf 
    Finished `release` profile [optimized] target(s) in 0.38s
warning: the cargo feature `edition2024` has been stabilized in the 1.85 release and is no longer necessary to be listed in the manifest
  See https://doc.rust-lang.org/cargo/reference/manifest.html#the-edition-field for more information about using this feature.
   Compiling dotenvy v0.15.7
   Compiling sol-program v0.1.0 (/Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 3.32s
     Running unittests src/lib.rs (target/debug/deps/sol_program-f9b148b856b1f087)

running 1 test
[2025-06-15T04:17:33.483947000Z INFO  solana_program_test] "sol_program" SBF program from /Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program/target/deploy/sol_program.so, modified 23 seconds, 153 ms, 687 Âµs and 422 ns ago
[2025-06-15T04:17:33.615883000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM invoke [1]
[2025-06-15T04:17:33.616384000Z DEBUG solana_runtime::message_processor::stable_log] Program log: Hello, Solana!
[2025-06-15T04:17:33.618020000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM consumed 137 of 200000 compute units
[2025-06-15T04:17:33.618034000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM success
test test::test_sol_program ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.24s

   Doc-tests sol_program

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 6.1s 
âœ solana airdrop 5                                          
Requesting airdrop of 5 SOL

Signature: 2z2Z9J9swicDcbLHeajCkwwM9C2BXZypLFpk9Fh4pQxQutnRqiuTuxAGuVTJz2qWF6hV5WjjTNC8ScF3PLtiuDqj

319.523949256 SOL

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 6.1s 
âœ solana airdrop 5                                          
Requesting airdrop of 5 SOL

Signature: 2z2Z9J9swicDcbLHeajCkwwM9C2BXZypLFpk9Fh4pQxQutnRqiuTuxAGuVTJz2qWF6hV5WjjTNC8ScF3PLtiuDqj

319.523949256 SOL

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 3.2s 
âœ du -h ./target/deploy/sol_program.so 
 20K    ./target/deploy/sol_program.so

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ solana balance                                             
319.523949256 SOL

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ source .env        

solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 9.4s 
âœ solana program deploy \
  --program-id ./target/deploy/sol_program-keypair.json \
  ./target/deploy/sol_program.so \
  -u $RPC_URL
Program Id: GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA

Signature: pwhfRtnXwc8kwFfkda1h7ZCRx3H4sGKEHrUbC9MhP4kPeGB8C7y24wcMCi6GMk56z78xQEYNADVpJVViCqXCEZa


```

### æµè§ˆå™¨æŸ¥çœ‹ç¨‹åº

- <https://solscan.io/account/GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA?cluster=devnet>

![image-20250615124222771](/images/image-20250615124222771.png)

- <https://explorer.solana.com/address/GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA?cluster=devnet&customUrl=http%3A%2F%2F127.0.0.1%3A8899>

![image-20250615124304554](/images/image-20250615124304554.png)

### client.rs æ–‡ä»¶

```rust
use anyhow::Result;
use dotenvy::dotenv;
use solana_client::rpc_client::RpcClient;
use solana_native_token::LAMPORTS_PER_SOL;
use solana_sdk::{
    commitment_config::CommitmentConfig,
    instruction::Instruction,
    pubkey::Pubkey,
    signature::{Keypair, Signer, read_keypair_file},
    transaction::Transaction,
};
use std::{env, path::Path, str::FromStr};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    dotenv().ok();

    let program_id = Pubkey::from_str("GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA")?;

    // let rpc_url = String::from("http://127.0.0.1:8899");
    let rpc_url =
        env::var("SOLANA_RPC_URL").unwrap_or_else(|_| "http://127.0.0.1:8899".to_string());
    let commitment_config = CommitmentConfig::confirmed();
    let rpc_client = RpcClient::new_with_commitment(rpc_url, commitment_config);

    // let keypair = Keypair::new();
    let keypair = load_keypair("./keys/SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN.json")?;
    println!("Keypair: {}", keypair.pubkey());

    let balance = rpc_client.get_balance(&keypair.pubkey())?;
    println!("Balance: {} SOL", balance as f64 / LAMPORTS_PER_SOL as f64);
    if balance < LAMPORTS_PER_SOL {
        println!("Requesting airdrop...");
        let signature = rpc_client
            .request_airdrop(&keypair.pubkey(), 2 * LAMPORTS_PER_SOL)
            .expect("Failed to request airdrop");
        loop {
            let confirmed =
                rpc_client.confirm_transaction_with_commitment(&signature, commitment_config)?;
            if confirmed.value {
                break;
            }
        }

        println!("Airdrop received");
    }

    let instruction = Instruction::new_with_borsh(program_id, &(), vec![]);

    let mut transaction = Transaction::new_with_payer(&[instruction], Some(&keypair.pubkey()));
    transaction.sign(&[&keypair], rpc_client.get_latest_blockhash()?);

    match rpc_client.send_and_confirm_transaction(&transaction) {
        Ok(signature) => println!("Transaction Signature: {}", signature),
        Err(err) => eprintln!("Error sending transaction: {}", err),
    }
    Ok(())
}

fn load_keypair(path: &str) -> anyhow::Result<Keypair> {
    if !Path::new(path).exists() {
        anyhow::bail!("Keypair file does not exist: {}", path);
    }
    read_keypair_file(path).map_err(|e| anyhow::anyhow!("Failed to read keypair: {}", e))
}

```

### è°ƒç”¨ç¨‹åº

#### ç¬¬ä¸€æ¬¡è°ƒç”¨

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ cargo run --example client
warning: the cargo feature `edition2024` has been stabilized in the 1.85 release and is no longer necessary to be listed in the manifest
  See https://doc.rust-lang.org/cargo/reference/manifest.html#the-edition-field for more information about using this feature.
   Compiling sol-program v0.1.0 (/Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 2.64s
     Running `target/debug/examples/client`
Keypair: SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN
Balance: 0 SOL
Requesting airdrop...

thread 'main' panicked at examples/client.rs:36:14:
Failed to request airdrop: Error { request: None, kind: RpcError(ForUser("airdrop request failed. This can happen when the rate limit is reached.")) }
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

#### è½¬è´¦ 2 SOl

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ solana transfer SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN 2 --allow-unfunded-recipient

Signature: rYcjrkJEqfaVBL1d3iYRcHk5hYeYEp2HajsGmKwcpm1MmeVfUSZp7NmMtcrMd2gJdSgrruxXeA2ksXxJmoALHNz


solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 3.5s 
âœ solana balance SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN                                            
2 SOL

```

#### å†æ¬¡è°ƒç”¨ç¨‹åº

```bash
solana-sandbox/sol-program on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) 
âœ cargo run --example client                                                              
warning: the cargo feature `edition2024` has been stabilized in the 1.85 release and is no longer necessary to be listed in the manifest
  See https://doc.rust-lang.org/cargo/reference/manifest.html#the-edition-field for more information about using this feature.
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.82s
     Running `target/debug/examples/client`
Keypair: SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN
Balance: 2 SOL
Transaction Signature: 5dBVgq32h17BdCX7CMFBZ8xsSDXZSKaEUs5xtL3q3rN6e1qG5v5CUe44BtGvqrcwjE8Bq91YvRA6AtEdJJf7rCm1

```

### æµè§ˆå™¨æŸ¥çœ‹äº¤æ˜“è¯¦æƒ…

- <https://explorer.solana.com/tx/5dBVgq32h17BdCX7CMFBZ8xsSDXZSKaEUs5xtL3q3rN6e1qG5v5CUe44BtGvqrcwjE8Bq91YvRA6AtEdJJf7rCm1?cluster=devnet&customUrl=http%3A%2F%2F127.0.0.1%3A8899>

![image-20250615125705405](/images/image-20250615125705405.png)

- <https://solscan.io/tx/5dBVgq32h17BdCX7CMFBZ8xsSDXZSKaEUs5xtL3q3rN6e1qG5v5CUe44BtGvqrcwjE8Bq91YvRA6AtEdJJf7rCm1?cluster=devnet>

![image-20250615125644674](/images/image-20250615125644674.png)

å¯ä»¥åœ¨ç¨‹åºæ—¥å¿—ä¸­çœ‹åˆ° "Hello, Solana!"ã€‚

### `src/lib.rs` æ›´æ–°ç¨‹åº

æˆ‘ä»¬å¯¹ç¨‹åºæ·»åŠ æ—¥å¿—å’Œäº‹ä»¶æ¥è¿›è¡Œæ›´æ–°æµ‹è¯•ã€‚

```rust
#![allow(unexpected_cfgs)]

use borsh_derive::{BorshDeserialize, BorshSerialize};
use solana_account_info::AccountInfo;
use solana_msg::msg;
use solana_program_entrypoint::entrypoint;
use solana_program_error::{ProgramError, ProgramResult};
use solana_pubkey::Pubkey;

// å®šä¹‰äº‹ä»¶ç»“æ„ä½“
#[derive(BorshDeserialize, BorshSerialize, Debug)]
pub struct GreetingEvent {
    pub message: String, // Greeting message contained in the event
}

// è‡ªå®šä¹‰äº‹ä»¶è§¦å‘å‡½æ•°
fn emit_event(event: &GreetingEvent) -> ProgramResult {
    let event_data = borsh::to_vec(event).map_err(|_| ProgramError::Custom(1))?; // Serialize to byte array
    msg!("EVENT:GREETING:{:?}", event_data); // Output event log
    Ok(())
}

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, Solana!");

    let event = GreetingEvent {
        message: "Hello from Solana program!".to_string(),
    };
    emit_event(&event)?;

    msg!("Program executed successfully with greeting event!");

    Ok(())
}

#[cfg(test)]
mod test {
    use solana_program_test::*;
    use solana_sdk::{
        instruction::Instruction, pubkey::Pubkey, signature::Signer, transaction::Transaction,
    };

    #[tokio::test]
    async fn test_sol_program() {
        // let program_id = Pubkey::from_str("GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA").unwrap();
        let program_id = Pubkey::new_unique();
        let mut program_test = ProgramTest::default();
        program_test.add_program("sol_program", program_id, None);
        let mut context = program_test.start_with_context().await;
        let (banks_client, payer, recent_blockhash) = (
            &mut context.banks_client,
            &context.payer,
            context.last_blockhash,
        );
        // Create instruction
        let instruction = Instruction {
            program_id,
            accounts: vec![],
            data: vec![],
        };
        // Create transaction with instruction
        let mut transaction = Transaction::new_with_payer(&[instruction], Some(&payer.pubkey()));

        // Sign transaction
        transaction.sign(&[&payer], recent_blockhash);

        let transaction_result = banks_client
            .process_transaction_with_metadata(transaction)
            .await
           .expect("Failed to process transaction");

        assert!(transaction_result.result.is_ok());

        let logs = transaction_result.metadata.unwrap().log_messages;
        assert!(logs.iter().any(|log| log.contains("Hello, Solana!")));
        assert!(logs.iter().any(|log| log.contains("EVENT:GREETING:")));
    }
}

```

### `start_with_context` å’Œ `start` ä¸»è¦åŒºåˆ«

| ç‰¹æ€§       | start_with_context                      | start                            |
| ---------- | --------------------------------------- | -------------------------------- |
| è¿”å›ç±»å‹   | ProgramTestContext                      | (BanksClient, Keypair, Hash)     |
| çµæ´»æ€§     | é«˜ï¼Œæä¾›å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œé€‚åˆå¤æ‚æµ‹è¯•        | ä½ï¼Œä»…æä¾›åŸºæœ¬ç»„ä»¶ï¼Œé€‚åˆç®€å•æµ‹è¯• |
| ä»£ç ç®€æ´æ€§ | ç¨å¤æ‚ï¼Œéœ€æ‰‹åŠ¨è§£æ„ä¸Šä¸‹æ–‡                | æ›´ç®€æ´ï¼Œç›´æ¥è¿”å›å…ƒç»„             |
| ä¸Šä¸‹æ–‡æ§åˆ¶ | ä¿ç•™ ProgramTestContextï¼Œå¯è¿›è¡Œé«˜çº§æ“ä½œ | æ— ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œé™åˆ¶é«˜çº§æ“ä½œ       |
| é€‚ç”¨åœºæ™¯   | å¤æ‚æµ‹è¯•ï¼ˆå¦‚æ—¶é—´æ¨è¿›ã€å¤šäº¤æ˜“ï¼‰          | ç®€å•æµ‹è¯•ï¼ˆå¦‚å•æ¬¡äº¤æ˜“éªŒè¯ï¼‰       |

### å¤„ç†äº¤æ˜“çš„æ–¹å¼ï¼šprocess_transaction å’Œ process_transaction_with_metadata  ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«

| ç‰¹æ€§           | process_transaction                                          | process_transaction_with_metadata                            |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| æ–¹æ³•ç­¾å       | async fn process_transaction(&mut self, transaction: Transaction) -> Result<(), BanksClientError> | async fn process_transaction_with_metadata(&mut self, transaction: Transaction) -> Result<TransactionExecutionDetails, BanksClientError> |
| è¿”å›å€¼         | Result<(), BanksClientError>                                 | Result<TransactionExecutionDetails, BanksClientError>        |
| è¿”å›å€¼å†…å®¹     | - æˆåŠŸï¼šOk(()) - å¤±è´¥ï¼šErr(BanksClientError)                 | - æˆåŠŸï¼šTransactionExecutionDetails åŒ…å«ï¼š  - result: Result<(), TransactionError>  - logs: Vec<String>  - units_consumed: u64  - return_data: Option<ProgramReturnData> - å¤±è´¥ï¼šErr(BanksClientError) |
| å…ƒæ•°æ®è®¿é—®     | æ— ï¼ˆä¸æä¾›æ—¥å¿—ã€è®¡ç®—å•å…ƒæˆ–è¿”å›æ•°æ®ï¼‰                         | æœ‰ï¼ˆæä¾›æ—¥å¿—ã€è®¡ç®—å•å…ƒæ¶ˆè€—ã€ç¨‹åºè¿”å›æ•°æ®ï¼‰                   |
| é”™è¯¯ç±»å‹       | å•ä¸€é”™è¯¯ï¼šBanksClientError                                   | ä¸¤å±‚é”™è¯¯ï¼š - BanksClientErrorï¼ˆå®¢æˆ·ç«¯é”™è¯¯ï¼‰ - TransactionErrorï¼ˆäº¤æ˜“æ‰§è¡Œé”™è¯¯ï¼‰ |
| é”™è¯¯å¤„ç†       | ç®€å•ï¼Œå•ä¸€é”™è¯¯ç±»å‹ï¼Œä¿¡æ¯è¾ƒé€šç”¨                               | å¤æ‚ï¼Œéœ€å¤„ç†åµŒå¥— result å­—æ®µï¼Œæ—¥å¿—å¯è¾…åŠ©è°ƒè¯•                 |
| ä»£ç ç¤ºä¾‹       | rust<br>let transaction_result = banks_client.process_transaction(transaction).await;<br>assert!(transaction_result.is_ok());<br> | rust<br>let transaction_result = banks_client.process_transaction_with_metadata(transaction).await.expect("Failed");<br>assert!(transaction_result.result.is_ok());<br> |
| ä»£ç ç®€æ´æ€§     | æ›´ç®€æ´ï¼Œé€‚åˆå¿«é€ŸéªŒè¯                                         | ç¨å¤æ‚ï¼Œéœ€è§£æ„ TransactionExecutionDetails                   |
| å®‰å…¨æ€§         | ç®€å•é”™è¯¯å¤„ç†ï¼Œæ— éœ€æ‹…å¿ƒåµŒå¥—é”™è¯¯                               | ä½¿ç”¨ unwrap() ä¸å®‰å…¨ï¼Œå»ºè®®ç”¨ expect æˆ– match                 |
| é€‚ç”¨åœºæ™¯       | - ç®€å•æµ‹è¯•ï¼šåªéœ€ç¡®è®¤äº¤æ˜“æˆåŠŸ - å¿«é€ŸåŸå‹ï¼šä¸å…³å¿ƒæ—¥å¿—æˆ–ç»†èŠ‚    | - å¤æ‚æµ‹è¯•ï¼šéœ€éªŒè¯æ—¥å¿—ã€äº‹ä»¶ã€è®¡ç®—å•å…ƒæˆ–è¿”å›æ•°æ® - è°ƒè¯•ï¼šæ£€æŸ¥ç¨‹åºè¾“å‡ºæˆ–é”™è¯¯ |
| ä½ çš„åœºæ™¯é€‚ç”¨æ€§ | é€‚åˆå½“å‰ç®€å•æµ‹è¯•ï¼ˆä»…éªŒè¯äº¤æ˜“æˆåŠŸï¼‰                           | æ›´é€‚åˆéªŒè¯ GreetingEvent æ—¥å¿—ï¼Œç¡®ä¿äº‹ä»¶æ­£ç¡®è¾“å‡º              |
| æ—¥å¿—éªŒè¯       | æ— æ³•ç›´æ¥è®¿é—®æ—¥å¿—ï¼Œéœ€é¢å¤–é…ç½®ï¼ˆå¦‚è‡ªå®šä¹‰æ—¥å¿—å¤„ç†å™¨ï¼‰           | å¯ç›´æ¥è®¿é—® logs å­—æ®µï¼ŒéªŒè¯ EVENT:GREETING ç­‰æ—¥å¿—             |
| æ¨èæ”¹è¿›       | ä¿æŒç®€æ´ï¼Œé€‚åˆåŸºæœ¬æµ‹è¯•                                       | åˆ‡æ¢åˆ°æ­¤æ–¹æ³•ä»¥éªŒè¯æ—¥å¿—ï¼Œé¿å… unwrap()ï¼Œä½¿ç”¨ expect æˆ– match  |

é€‰æ‹©å»ºè®®ï¼šè‹¥éœ€éªŒè¯äº‹ä»¶æˆ–æ—¥å¿—ï¼Œprocess_transaction_with_metadata æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼›è‹¥ä»…éœ€ç¡®è®¤äº¤æ˜“æˆåŠŸï¼Œprocess_transaction æ›´ç®€æ´ã€‚

### ç¼–è¯‘æ„å»ºæµ‹è¯•ç¨‹åº

```bash
solana-sandbox/sol-program on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 5.0s 
âœ cargo build-sbf
   Compiling sol-program v0.1.0 (/Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program)
    Finished `release` profile [optimized] target(s) in 0.88s

solana-sandbox/sol-program on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 2.0s 
âœ cargo test-sbf 
    Finished `release` profile [optimized] target(s) in 0.13s
warning: the cargo feature `edition2024` has been stabilized in the 1.85 release and is no longer necessary to be listed in the manifest
  See https://doc.rust-lang.org/cargo/reference/manifest.html#the-edition-field for more information about using this feature.
   Compiling sol-program v0.1.0 (/Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 2.60s
     Running unittests src/lib.rs (target/debug/deps/sol_program-525371d62f45d448)

running 1 test
[2025-06-15T07:55:18.734968000Z INFO  solana_program_test] "sol_program" SBF program from /Users/qiaopengjun/Code/Solana/solana-sandbox/sol-program/target/deploy/sol_program.so, modified 6 seconds, 475 ms, 649 Âµs and 321 ns ago
[2025-06-15T07:55:18.851542000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM invoke [1]
[2025-06-15T07:55:18.852074000Z DEBUG solana_runtime::message_processor::stable_log] Program log: Hello, Solana!
[2025-06-15T07:55:18.853240000Z DEBUG solana_runtime::message_processor::stable_log] Program log: EVENT:GREETING:[26, 0, 0, 0, 72, 101, 108, 108, 111, 32, 102, 114, 111, 109, 32, 83, 111, 108, 97, 110, 97, 32, 112, 114, 111, 103, 114, 97, 109, 33]
[2025-06-15T07:55:18.853249000Z DEBUG solana_runtime::message_processor::stable_log] Program log: Program executed successfully with greeting event!
[2025-06-15T07:55:18.854872000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM consumed 7280 of 200000 compute units
[2025-06-15T07:55:18.854891000Z DEBUG solana_runtime::message_processor::stable_log] Program 1111111QLbz7JHiBTspS962RLKV8GndWFwiEaqKM success
test test::test_sol_program ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.23s

   Doc-tests sol_program

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

```

### æ›´æ–°ç¨‹åº

```bash
solana-sandbox/sol-program on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 4.4s 
âœ solana program deploy \                                   
  --program-id ./target/deploy/sol_program-keypair.json \
  ./target/deploy/sol_program.so \
  -u $RPC_URL
Program Id: GGBjDqYdicSE6Qmtu6SAsueX1biM5LjbJ8R8vZvFfofA

Signature: 4PgkQvWY9CCLuU1yoHC5bHtBQcBncUtuRNPXnzddLkrn8soSNrzkSDCLYU55uJtLhWcDKruYA5rcGaRXGPZoRjsq

```

### è¿è¡Œå®¢æˆ·ç«¯ç¨‹åº

```bash
solana-sandbox/sol-program on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.87.0 on ğŸ³ v28.2.2 (orbstack) took 21.1s 
âœ cargo run --example client
warning: the cargo feature `edition2024` has been stabilized in the 1.85 release and is no longer necessary to be listed in the manifest
  See https://doc.rust-lang.org/cargo/reference/manifest.html#the-edition-field for more information about using this feature.
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.85s
     Running `target/debug/examples/client`
Keypair: SSoyAkBN9E3CjbWpr2SdgLa6Ejbqqdvasuxd8j1YsmN
Balance: 1.999995 SOL
Transaction Signature: 4DFyj2xgVddy4inaaSbCJ6UeVMSM3u65LavC6tjVSsaw3A8PWLMz6jnuJ39o3A6WHhJV36UF5rYcVhnbgrkwEcqv

```

### æµè§ˆå™¨æŸ¥çœ‹

- <https://explorer.solana.com/tx/4DFyj2xgVddy4inaaSbCJ6UeVMSM3u65LavC6tjVSsaw3A8PWLMz6jnuJ39o3A6WHhJV36UF5rYcVhnbgrkwEcqv?cluster=devnet&customUrl=http%3A%2F%2F127.0.0.1%3A8899>

![image-20250615160627873](/images/image-20250615160627873.png)

- <https://solscan.io/tx/4DFyj2xgVddy4inaaSbCJ6UeVMSM3u65LavC6tjVSsaw3A8PWLMz6jnuJ39o3A6WHhJV36UF5rYcVhnbgrkwEcqv?cluster=devnet>

![image-20250615160728136](/images/image-20250615160728136.png)

## æ€»ç»“

é€šè¿‡åœ¨ Solana Devnet ä¸Šçš„å®è·µï¼Œæœ¬æ–‡å±•ç¤ºäº†ä»å¯†é’¥å¯¹ç”Ÿæˆåˆ°é“¾ä¸Šç¨‹åºæ›´æ–°ä¸è°ƒç”¨çš„å®Œæ•´å¼€å‘æµç¨‹ï¼ŒåŠ©åŠ›å¼€å‘è€…ä»æœ¬åœ°æµ‹è¯•è¿ˆå‘æ›´è´´è¿‘ç”Ÿäº§ç¯å¢ƒçš„å¼€å‘ã€‚æ ¸å¿ƒå†…å®¹åŒ…æ‹¬ï¼šä½¿ç”¨ solana-keygen grind ç”Ÿæˆå®šåˆ¶é’±åŒ…åœ°å€ï¼›é€šè¿‡ solana program deploy éƒ¨ç½² Rust ç¨‹åºå¹¶éªŒè¯ï¼›åˆ©ç”¨ Rust å®¢æˆ·ç«¯è°ƒç”¨é“¾ä¸Šç¨‹åºå¹¶å¤„ç†ç©ºæŠ•ï¼›é€šè¿‡æ·»åŠ æ—¥å¿—å’Œäº‹ä»¶æ›´æ–°ç¨‹åºå¹¶ç¡®è®¤æ•ˆæœï¼›å¯¹æ¯” start_with_context ä¸ startã€ä»¥åŠ process_transaction ä¸ process_transaction_with_metadataï¼Œä¼˜åŒ–æµ‹è¯•ä¸è°ƒè¯•æ•ˆç‡ã€‚æœ¬æ–‡ä¸ºå¼€å‘è€…æä¾›äº†ä»æœ¬åœ°åˆ° Devnet çš„è¿›é˜¶è·¯å¾„ï¼Œæœªæ¥å¯è¿›ä¸€æ­¥æ¢ç´¢ Anchor æ¡†æ¶æˆ–å¤æ‚é“¾ä¸Šé€»è¾‘ï¼Œæ•¬è¯·å…³æ³¨ç³»åˆ—åç»­å†…å®¹ï¼

## å‚è€ƒ

- <https://solana.com/zh/docs/programs/deploying>
- <https://solana.com/zh/docs/intro/installation>
- <https://docs.rs/borsh/latest/borsh/>
- <https://www.solanazh.com/course/5-4>
- <https://www.anchor-lang.com/docs>
- <https://explorer.solana.com/tx/4DFyj2xgVddy4inaaSbCJ6UeVMSM3u65LavC6tjVSsaw3A8PWLMz6jnuJ39o3A6WHhJV36UF5rYcVhnbgrkwEcqv?cluster=devnet&customUrl=http%3A%2F%2F127.0.0.1%3A8899>
- <https://solscan.io/tx/4DFyj2xgVddy4inaaSbCJ6UeVMSM3u65LavC6tjVSsaw3A8PWLMz6jnuJ39o3A6WHhJV36UF5rYcVhnbgrkwEcqv?cluster=devnet>
