+++
title = "Go è¯­è¨€ä¹‹ zap æ—¥å¿—åº“ç®€å•ä½¿ç”¨"
date = 2023-06-16T18:19:42+08:00
description = "Go è¯­è¨€ä¹‹ zap æ—¥å¿—åº“ç®€å•ä½¿ç”¨"
[taxonomies]
tags = ["Go"]
categories = ["Go"]
+++

# Go è¯­è¨€ä¹‹ zap æ—¥å¿—åº“ç®€å•ä½¿ç”¨

## é»˜è®¤çš„ Go log

logï¼š<https://pkg.go.dev/log>

```go
package main

import (
 "log"
 "os"
)

func init() {
 log.SetPrefix("LOG: ") // è®¾ç½®å‰ç¼€

 f, err := os.OpenFile("./log.log", os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0644)
 if err != nil {
  log.Fatalf("open log file failed with error: %v", err)
 }
 log.SetOutput(f) // è®¾ç½®è¾“å‡º

 log.SetFlags(log.Ldate | log.Ltime | log.Lmicroseconds | log.Llongfile)

 // const (
 //  Ldate         = 1 << iota // 1 << 0 = 000000001 = 1
 //  Ltime                     // 1 << 1 = 000000010 = 2
 //  Lmicroseconds             // 1 << 2 = 000000100 = 4
 //  Llongfile                 // 1 << 3 = 000001000 = 8
 //  Lshortfile                // 1 << 4 = 000010000 = 16
 //  ...
 // )
}

func main() {
 log.Println("1234")

 // log.Fatalln("1234")

 // log.Panicln("1234")

 // log.Panic("1234")
 // log.Panicf("1234, %d", 5678)
}

```

log åŒ…æ˜¯ä¸€ä¸ªç®€å•çš„æ—¥å¿—åŒ…ã€‚

Package log implements a simple logging package. It defines a type, Logger, with methods for formatting output. It also has a predefined 'standard' Logger accessible through helper functions Print[f|ln], Fatal[f|ln], and Panic[f|ln], which are easier to use than creating a Logger manually. That logger writes to standard error and prints the date and time of each logged message. Every log message is output on a separate line: if the message being printed does not end in a newline, the logger will add one. The Fatal functions call os.Exit(1) after writing the log message. The Panic functions call panic after writing the log message.

## uber-go zap

[log](https://pkg.go.dev/log)ï¼š<https://pkg.go.dev/log>

[github zap](https://github.com/uber-go/zap)ï¼š<https://github.com/uber-go/zap>

[pkg zap](https://pkg.go.dev/go.uber.org/zap#section-readme)ï¼š<https://pkg.go.dev/go.uber.org/zap#section-readme>

Blazing fast, structured, leveled logging in Go.

### å®‰è£…

```bash
go get -u go.uber.org/zap
```

åœ¨æ€§èƒ½è‰¯å¥½ä½†ä¸æ˜¯å…³é”®çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨ `SugaredLogger`ã€‚å®ƒæ¯”å…¶ä»–ç»“æ„åŒ–æ—¥å¿—åŒ…å¿«4-10å€ï¼ŒåŒ…æ‹¬ç»“æ„åŒ–å’Œ printf é£æ ¼çš„ APIã€‚

```go
logger, _ := zap.NewProduction()
defer logger.Sync() // flushes buffer, if any
sugar := logger.Sugar()
sugar.Infow("failed to fetch URL",
  // Structured context as loosely typed key-value pairs.
  "url", url,
  "attempt", 3,
  "backoff", time.Second,
)
sugar.Infof("Failed to fetch URL: %s", url)
```

å½“æ€§èƒ½å’Œç±»å‹å®‰å…¨è‡³å…³é‡è¦æ—¶ï¼Œè¯·ä½¿ç”¨`Logger`ã€‚å®ƒç”šè‡³æ¯”`SugaredLogger` æ›´å¿«ï¼Œåˆ†é…ä¹Ÿå°‘å¾—å¤šï¼Œä½†å®ƒåªæ”¯æŒç»“æ„åŒ–æ—¥å¿—è®°å½•ã€‚

```go
logger, _ := zap.NewProduction()
defer logger.Sync()
logger.Info("failed to fetch URL",
  // Structured context as strongly typed Field values.
  zap.String("url", url),
  zap.Int("attempt", 3),
  zap.Duration("backoff", time.Second),
)
```

[zapæ–‡æ¡£](https://pkg.go.dev/go.uber.org/zap#section-readme)ï¼š<https://pkg.go.dev/go.uber.org/zap#section-readme>

### Logger ç®€å•ä½¿ç”¨

```go
package main

import (
 "go.uber.org/zap"
 "net/http"
)

// å®šä¹‰ä¸€ä¸ªå…¨å±€ logger å®ä¾‹
// Loggeræä¾›å¿«é€Ÿã€åˆ†çº§ã€ç»“æ„åŒ–çš„æ—¥å¿—è®°å½•ã€‚æ‰€æœ‰æ–¹æ³•å¯¹äºå¹¶å‘ä½¿ç”¨éƒ½æ˜¯å®‰å…¨çš„ã€‚
// Loggeræ˜¯ä¸ºæ¯ä¸€å¾®ç§’å’Œæ¯ä¸€ä¸ªåˆ†é…éƒ½å¾ˆé‡è¦çš„ä¸Šä¸‹æ–‡è®¾è®¡çš„ï¼Œ
// å› æ­¤å®ƒçš„APIæœ‰æ„å€¾å‘äºæ€§èƒ½å’Œç±»å‹å®‰å…¨ï¼Œè€Œä¸æ˜¯ç®€ä¾¿æ€§ã€‚
// å¯¹äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼ŒSugaredLoggeråœ¨æ€§èƒ½å’Œäººä½“å·¥ç¨‹å­¦ä¹‹é—´å–å¾—äº†æ›´å¥½çš„å¹³è¡¡ã€‚
var logger *zap.Logger

func main() {
 // åˆå§‹åŒ–
 InitLogger()
 // Syncè°ƒç”¨åº•å±‚Coreçš„Syncæ–¹æ³•ï¼Œåˆ·æ–°æ‰€æœ‰ç¼“å†²çš„æ—¥å¿—æ¡ç›®ã€‚åº”ç”¨ç¨‹åºåœ¨é€€å‡ºä¹‹å‰åº”è¯¥æ³¨æ„è°ƒç”¨Syncã€‚
 // åœ¨ç¨‹åºé€€å‡ºä¹‹å‰ï¼ŒæŠŠç¼“å†²åŒºé‡Œçš„æ—¥å¿—åˆ·åˆ°ç£ç›˜ä¸Š
 defer logger.Sync()
 simpleHttpGet("www.baidu.com")
 simpleHttpGet("http://www.baidu.com")
}

func InitLogger() {
 // NewProductionæ„å»ºäº†ä¸€ä¸ªåˆç†çš„ç”Ÿäº§Loggerï¼Œå®ƒå°†infollevelåŠä»¥ä¸Šçš„æ—¥å¿—ä»¥JSONçš„å½¢å¼å†™å…¥æ ‡å‡†é”™è¯¯ã€‚
 // It's a shortcut for NewProductionConfig().Build(...Option).
 logger, _ = zap.NewProduction()
}

func simpleHttpGet(url string) {
 // Getå‘æŒ‡å®šçš„URLå‘å‡ºGetå‘½ä»¤ã€‚å¦‚æœå“åº”æ˜¯ä»¥ä¸‹é‡å®šå‘ä»£ç ä¹‹ä¸€ï¼Œåˆ™Getè·Ÿéšé‡å®šå‘ï¼Œæœ€å¤šå¯é‡å®šå‘10ä¸ª:
 // 301 (Moved Permanently)
 // 302 (Found)
 // 303 (See Other)
 // 307 (Temporary Redirect)
 // 308 (Permanent Redirect)
 // Get is a wrapper around DefaultClient.Get.
 // ä½¿ç”¨NewRequestå’ŒDefaultClient.Doæ¥å‘å‡ºå¸¦æœ‰è‡ªå®šä¹‰å¤´çš„è¯·æ±‚ã€‚
 resp, err := http.Get(url)
 if err != nil {
  // Erroråœ¨ErrorLevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  logger.Error(
   "Error fetching url..",
   zap.String("url", url), // å­—ç¬¦ä¸²ç”¨ç»™å®šçš„é”®å’Œå€¼æ„é€ ä¸€ä¸ªå­—æ®µã€‚
   zap.Error(err))         // // Error is shorthand for the common idiom NamedError("error", err).
 } else {
  // Infoä»¥infollevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  logger.Info("Success..",
   zap.String("statusCode", resp.Status),
   zap.String("url", url))
  resp.Body.Close()
 }
}

```

è¿è¡Œ

```bash
Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base took 11.0s 
âœ go run main.go 
{"level":"error","ts":1686929392.121357,"caller":"zap_demo/main.go:42","msg":"Error fetching url..","url":"www.google.com","error":"Get \"www.google.com\": unsupported protocol scheme \"\"","stacktrace":"main.simpleHttpGet\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:42\nmain.main\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:21\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"error","ts":1686929422.123222,"caller":"zap_demo/main.go:42","msg":"Error fetching url..","url":"http://www.google.com","error":"Get \"http://www.google.com\": dial tcp 103.252.115.59:80: i/o timeout","stacktrace":"main.simpleHttpGet\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:42\nmain.main\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:22\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}

Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base took 30.3s 
âœ go run main.go
{"level":"error","ts":1686929534.4672909,"caller":"zap_demo/main.go:42","msg":"Error fetching url..","url":"www.baidu.com","error":"Get \"www.baidu.com\": unsupported protocol scheme \"\"","stacktrace":"main.simpleHttpGet\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:42\nmain.main\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:21\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"info","ts":1686929535.561184,"caller":"zap_demo/main.go:47","msg":"Success..","statusCode":"200 OK","url":"http://www.baidu.com"}

Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base 
âœ 
```

### æºç 

```go
// Level reports the minimum enabled level for this logger.
//
// For NopLoggers, this is [zapcore.InvalidLevel].
func (log *Logger) Level() zapcore.Level {
 return zapcore.LevelOf(log.core)
}

// Check returns a CheckedEntry if logging a message at the specified level
// is enabled. It's a completely optional optimization; in high-performance
// applications, Check can help avoid allocating a slice to hold fields.
func (log *Logger) Check(lvl zapcore.Level, msg string) *zapcore.CheckedEntry {
 return log.check(lvl, msg)
}

// Log logs a message at the specified level. The message includes any fields
// passed at the log site, as well as any fields accumulated on the logger.
func (log *Logger) Log(lvl zapcore.Level, msg string, fields ...Field) {
 if ce := log.check(lvl, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Debug logs a message at DebugLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
func (log *Logger) Debug(msg string, fields ...Field) {
 if ce := log.check(DebugLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Info logs a message at InfoLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
func (log *Logger) Info(msg string, fields ...Field) {
 if ce := log.check(InfoLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Warn logs a message at WarnLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
func (log *Logger) Warn(msg string, fields ...Field) {
 if ce := log.check(WarnLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Error logs a message at ErrorLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
func (log *Logger) Error(msg string, fields ...Field) {
 if ce := log.check(ErrorLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// DPanic logs a message at DPanicLevel. The message includes any fields
// passed at the log site, as well as any fields accumulated on the logger.
//
// If the logger is in development mode, it then panics (DPanic means
// "development panic"). This is useful for catching errors that are
// recoverable, but shouldn't ever happen.
func (log *Logger) DPanic(msg string, fields ...Field) {
 if ce := log.check(DPanicLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Panic logs a message at PanicLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
//
// The logger then panics, even if logging at PanicLevel is disabled.
func (log *Logger) Panic(msg string, fields ...Field) {
 if ce := log.check(PanicLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}

// Fatal logs a message at FatalLevel. The message includes any fields passed
// at the log site, as well as any fields accumulated on the logger.
//
// The logger then calls os.Exit(1), even if logging at FatalLevel is
// disabled.
func (log *Logger) Fatal(msg string, fields ...Field) {
 if ce := log.check(FatalLevel, msg); ce != nil {
  ce.Write(fields...)
 }
}
```

#### æ¯ä¸ª`zapcore.Field`å…¶å®å°±æ˜¯ä¸€ç»„é”®å€¼å¯¹å‚æ•°

```go
// Field is an alias for Field. Aliasing this type dramatically
// improves the navigability of this package's API documentation.
type Field = zapcore.Field
```

#### è¾“å‡ºçš„æ˜¯ JSON æ ¼å¼çš„æ—¥å¿—

### SugaredLogger ç®€å•ä½¿ç”¨

#### NewProduction

```go
package main

import (
 "go.uber.org/zap"
 "net/http"
)

// å®šä¹‰ä¸€ä¸ªå…¨å±€ logger å®ä¾‹
// Loggeræä¾›å¿«é€Ÿã€åˆ†çº§ã€ç»“æ„åŒ–çš„æ—¥å¿—è®°å½•ã€‚æ‰€æœ‰æ–¹æ³•å¯¹äºå¹¶å‘ä½¿ç”¨éƒ½æ˜¯å®‰å…¨çš„ã€‚
// Loggeræ˜¯ä¸ºæ¯ä¸€å¾®ç§’å’Œæ¯ä¸€ä¸ªåˆ†é…éƒ½å¾ˆé‡è¦çš„ä¸Šä¸‹æ–‡è®¾è®¡çš„ï¼Œ
// å› æ­¤å®ƒçš„APIæœ‰æ„å€¾å‘äºæ€§èƒ½å’Œç±»å‹å®‰å…¨ï¼Œè€Œä¸æ˜¯ç®€ä¾¿æ€§ã€‚
// å¯¹äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼ŒSugaredLoggeråœ¨æ€§èƒ½å’Œäººä½“å·¥ç¨‹å­¦ä¹‹é—´å–å¾—äº†æ›´å¥½çš„å¹³è¡¡ã€‚
var logger *zap.Logger

var sugarLogger *zap.SugaredLogger

func main() {
 // åˆå§‹åŒ–
 InitLogger()
 // Syncè°ƒç”¨åº•å±‚Coreçš„Syncæ–¹æ³•ï¼Œåˆ·æ–°æ‰€æœ‰ç¼“å†²çš„æ—¥å¿—æ¡ç›®ã€‚åº”ç”¨ç¨‹åºåœ¨é€€å‡ºä¹‹å‰åº”è¯¥æ³¨æ„è°ƒç”¨Syncã€‚
 // åœ¨ç¨‹åºé€€å‡ºä¹‹å‰ï¼ŒæŠŠç¼“å†²åŒºé‡Œçš„æ—¥å¿—åˆ·åˆ°ç£ç›˜ä¸Š
 defer logger.Sync()
 simpleHttpGet("www.baidu.com")
 simpleHttpGet("http://www.baidu.com")
}

func InitLogger() {
 // NewProductionæ„å»ºäº†ä¸€ä¸ªåˆç†çš„ç”Ÿäº§Loggerï¼Œå®ƒå°†infollevelåŠä»¥ä¸Šçš„æ—¥å¿—ä»¥JSONçš„å½¢å¼å†™å…¥æ ‡å‡†é”™è¯¯ã€‚
 // It's a shortcut for NewProductionConfig().Build(...Option).
 logger, _ = zap.NewProduction()
 sugarLogger = logger.Sugar()
}

func simpleHttpGet(url string) {
 // Getå‘æŒ‡å®šçš„URLå‘å‡ºGetå‘½ä»¤ã€‚å¦‚æœå“åº”æ˜¯ä»¥ä¸‹é‡å®šå‘ä»£ç ä¹‹ä¸€ï¼Œåˆ™Getè·Ÿéšé‡å®šå‘ï¼Œæœ€å¤šå¯é‡å®šå‘10ä¸ª:
 // 301 (Moved Permanently)
 // 302 (Found)
 // 303 (See Other)
 // 307 (Temporary Redirect)
 // 308 (Permanent Redirect)
 // Get is a wrapper around DefaultClient.Get.
 // ä½¿ç”¨NewRequestå’ŒDefaultClient.Doæ¥å‘å‡ºå¸¦æœ‰è‡ªå®šä¹‰å¤´çš„è¯·æ±‚ã€‚
 resp, err := http.Get(url)
 if err != nil {
  // Erroråœ¨ErrorLevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  //logger.Error(
  sugarLogger.Error(
   "Error fetching url..",
   zap.String("url", url), // å­—ç¬¦ä¸²ç”¨ç»™å®šçš„é”®å’Œå€¼æ„é€ ä¸€ä¸ªå­—æ®µã€‚
   zap.Error(err))         // // Error is shorthand for the common idiom NamedError("error", err).
 } else {
  // Infoä»¥infollevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  //logger.Info("Success..",
  sugarLogger.Info("Success..",
   zap.String("statusCode", resp.Status),
   zap.String("url", url))
  resp.Body.Close()
 }
}

```

è¿è¡Œ

```bash
Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base 
âœ go run main.go
{"level":"error","ts":1686930454.798492,"caller":"zap_demo/main.go:47","msg":"Error fetching url..{url 15 0 www.baidu.com <nil>} {error 26 0  Get \"www.baidu.com\": unsupported protocol scheme \"\"}","stacktrace":"main.simpleHttpGet\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:47\nmain.main\n\t/Users/qiaopengjun/Code/go/zap_demo/main.go:23\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"info","ts":1686930454.83406,"caller":"zap_demo/main.go:54","msg":"Success..{statusCode 15 0 200 OK <nil>} {url 15 0 http://www.baidu.com <nil>}"}

Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base 
âœ 
```

#### NewDevelopment

```go
package main

import (
 "go.uber.org/zap"
 "net/http"
)

// å®šä¹‰ä¸€ä¸ªå…¨å±€ logger å®ä¾‹
// Loggeræä¾›å¿«é€Ÿã€åˆ†çº§ã€ç»“æ„åŒ–çš„æ—¥å¿—è®°å½•ã€‚æ‰€æœ‰æ–¹æ³•å¯¹äºå¹¶å‘ä½¿ç”¨éƒ½æ˜¯å®‰å…¨çš„ã€‚
// Loggeræ˜¯ä¸ºæ¯ä¸€å¾®ç§’å’Œæ¯ä¸€ä¸ªåˆ†é…éƒ½å¾ˆé‡è¦çš„ä¸Šä¸‹æ–‡è®¾è®¡çš„ï¼Œ
// å› æ­¤å®ƒçš„APIæœ‰æ„å€¾å‘äºæ€§èƒ½å’Œç±»å‹å®‰å…¨ï¼Œè€Œä¸æ˜¯ç®€ä¾¿æ€§ã€‚
// å¯¹äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼ŒSugaredLoggeråœ¨æ€§èƒ½å’Œäººä½“å·¥ç¨‹å­¦ä¹‹é—´å–å¾—äº†æ›´å¥½çš„å¹³è¡¡ã€‚
var logger *zap.Logger

// SugaredLoggerå°†åŸºæœ¬çš„LoggeråŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªè¾ƒæ…¢ä½†ä¸é‚£ä¹ˆå†—é•¿çš„APIä¸­ã€‚ä»»ä½•Loggeréƒ½å¯ä»¥é€šè¿‡å…¶Sugaræ–¹æ³•è½¬æ¢ä¸ºsugardloggerã€‚
//ä¸Loggerä¸åŒï¼ŒSugaredLoggerå¹¶ä¸åšæŒç»“æ„åŒ–æ—¥å¿—è®°å½•ã€‚å¯¹äºæ¯ä¸ªæ—¥å¿—çº§åˆ«ï¼Œå®ƒå…¬å¼€äº†å››ä¸ªæ–¹æ³•:
//   - methods named after the log level for log.Print-style logging
//   - methods ending in "w" for loosely-typed structured logging
//   - methods ending in "f" for log.Printf-style logging
//   - methods ending in "ln" for log.Println-style logging

// For example, the methods for InfoLevel are:
//
// Info(...any)           Print-style logging
// Infow(...any)          Structured logging (read as "info with")
// Infof(string, ...any)  Printf-style logging
// Infoln(...any)         Println-style logging
var sugarLogger *zap.SugaredLogger

func main() {
 // åˆå§‹åŒ–
 InitLogger()
 // Syncè°ƒç”¨åº•å±‚Coreçš„Syncæ–¹æ³•ï¼Œåˆ·æ–°æ‰€æœ‰ç¼“å†²çš„æ—¥å¿—æ¡ç›®ã€‚åº”ç”¨ç¨‹åºåœ¨é€€å‡ºä¹‹å‰åº”è¯¥æ³¨æ„è°ƒç”¨Syncã€‚
 // åœ¨ç¨‹åºé€€å‡ºä¹‹å‰ï¼ŒæŠŠç¼“å†²åŒºé‡Œçš„æ—¥å¿—åˆ·åˆ°ç£ç›˜ä¸Š
 defer logger.Sync()
 simpleHttpGet("www.baidu.com")
 simpleHttpGet("http://www.baidu.com")
}

func InitLogger() {
 // NewProductionæ„å»ºäº†ä¸€ä¸ªåˆç†çš„ç”Ÿäº§Loggerï¼Œå®ƒå°†infollevelåŠä»¥ä¸Šçš„æ—¥å¿—ä»¥JSONçš„å½¢å¼å†™å…¥æ ‡å‡†é”™è¯¯ã€‚
 // It's a shortcut for NewProductionConfig().Build(...Option).
 //logger, _ = zap.NewProduction()
 // NewDevelopmentæ„å»ºä¸€ä¸ªå¼€å‘æ—¥å¿—ï¼Œå®ƒä»¥ä¸€ç§äººæ€§åŒ–çš„æ ¼å¼å°†DebugLevelåŠä»¥ä¸Šçš„æ—¥å¿—å†™å…¥æ ‡å‡†é”™è¯¯ã€‚
 logger, _ = zap.NewDevelopment()
 // Sugarå°è£…äº†Loggerï¼Œä»¥æä¾›æ›´ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„APIï¼Œä½†é€Ÿåº¦ç•¥æ…¢ã€‚ç³–åŒ–ä¸€ä¸ªLoggerçš„æˆæœ¬éå¸¸ä½ï¼Œ
 // å› æ­¤ä¸€ä¸ªåº”ç”¨ç¨‹åºåŒæ—¶ä½¿ç”¨Loggerå’Œsugaredloggeræ˜¯åˆç†çš„ï¼Œåœ¨æ€§èƒ½æ•æ„Ÿä»£ç çš„è¾¹ç•Œä¸Šåœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚
 sugarLogger = logger.Sugar()
}

func simpleHttpGet(url string) {
 // Getå‘æŒ‡å®šçš„URLå‘å‡ºGetå‘½ä»¤ã€‚å¦‚æœå“åº”æ˜¯ä»¥ä¸‹é‡å®šå‘ä»£ç ä¹‹ä¸€ï¼Œåˆ™Getè·Ÿéšé‡å®šå‘ï¼Œæœ€å¤šå¯é‡å®šå‘10ä¸ª:
 // 301 (Moved Permanently)
 // 302 (Found)
 // 303 (See Other)
 // 307 (Temporary Redirect)
 // 308 (Permanent Redirect)
 // Get is a wrapper around DefaultClient.Get.
 // ä½¿ç”¨NewRequestå’ŒDefaultClient.Doæ¥å‘å‡ºå¸¦æœ‰è‡ªå®šä¹‰å¤´çš„è¯·æ±‚ã€‚
 resp, err := http.Get(url)
 if err != nil {
  // Erroråœ¨ErrorLevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  //logger.Error(
  
  // é”™è¯¯ä½¿ç”¨fmtã€‚ä»¥Sprintæ–¹å¼æ„é€ å’Œè®°å½•æ¶ˆæ¯ã€‚
  sugarLogger.Error(
   "Error fetching url..",
   zap.String("url", url), // å­—ç¬¦ä¸²ç”¨ç»™å®šçš„é”®å’Œå€¼æ„é€ ä¸€ä¸ªå­—æ®µã€‚
   zap.Error(err))         // // Error is shorthand for the common idiom NamedError("error", err).
 } else {
  // Infoä»¥infollevelè®°å½•æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯åŒ…æ‹¬åœ¨æ—¥å¿—ç«™ç‚¹ä¼ é€’çš„ä»»ä½•å­—æ®µï¼Œä»¥åŠæ—¥å¿—è®°å½•å™¨ä¸Šç§¯ç´¯çš„ä»»ä½•å­—æ®µã€‚
  //logger.Info("Success..",
  
  // Infoä½¿ç”¨fmtã€‚ä»¥Sprintæ–¹å¼æ„é€ å’Œè®°å½•æ¶ˆæ¯ã€‚
  sugarLogger.Info("Success..",
   zap.String("statusCode", resp.Status),
   zap.String("url", url))
  resp.Body.Close()
 }
}

```

è¿è¡Œ

```bash
Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base 
âœ go run main.go
2023-06-16T23:52:00.384+0800    ERROR   zap_demo/main.go:48     Error fetching url..{url 15 0 www.baidu.com <nil>} {error 26 0  Get "www.baidu.com": unsupported protocol scheme ""}
main.simpleHttpGet
        /Users/qiaopengjun/Code/go/zap_demo/main.go:48
main.main
        /Users/qiaopengjun/Code/go/zap_demo/main.go:23
runtime.main
        /usr/local/go/src/runtime/proc.go:250
2023-06-16T23:52:00.439+0800    INFO    zap_demo/main.go:55     Success..{statusCode 15 0 200 OK <nil>} {url 15 0 http://www.baidu.com <nil>}

Code/go/zap_demo via ğŸ¹ v1.20.3 via ğŸ…’ base 
âœ 
```
