+++
title = "Web3 å®æˆ˜ï¼šå¼€å‘ä½ çš„ ERC20 ä»£å¸åˆçº¦"
description = "Web3 å®æˆ˜ï¼šå¼€å‘ä½ çš„ ERC20 ä»£å¸åˆçº¦"
date = 2025-03-29 22:06:27+08:00
[taxonomies]
categories = ["Web3"]
tags = ["Web3"]
+++

<!-- more -->

# Web3 å®æˆ˜ï¼šå¼€å‘ä½ çš„ ERC20 ä»£å¸åˆçº¦

åŒºå—é“¾æŠ€æœ¯æ­£åœ¨æ€èµ· Web3 é©å‘½ï¼Œè€Œ ERC20 ä»£å¸ä½œä¸ºä»¥å¤ªåŠç”Ÿæ€çš„æ˜æ˜Ÿæ ‡å‡†ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½è½»æ¾åˆ›å»ºå±äºè‡ªå·±çš„æ•°å­—èµ„äº§ã€‚ä½ æ˜¯å¦å¥½å¥‡å¦‚ä½•ä»é›¶å¼€å§‹æ‰“é€ ä¸€ä¸ªä»£å¸åˆçº¦ï¼Ÿæœ¬æ–‡å°†å¸¦ä½ èµ°è¿› Web3 çš„å®æˆ˜ä¸–ç•Œï¼Œé€šè¿‡æ¸…æ™°çš„ä»£ç ç¤ºä¾‹å’Œéƒ¨ç½²æ­¥éª¤ï¼Œè§£é” ERC20 ä»£å¸å¼€å‘çš„å®Œæ•´æµç¨‹ã€‚æ— è®ºä½ æ˜¯æ–°æ‰‹è¿˜æ˜¯å¼€å‘è€…ï¼Œè¿™åœºå®æˆ˜ä¹‹æ—…éƒ½å°†è®©ä½ æ”¶è·æ»¡æ»¡ï¼

æœ¬æ–‡é€šè¿‡ä¸€ä¸ªçœŸå®çš„æ¡ˆä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Solidity ç¼–å†™å¹¶éƒ¨ç½²ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ ERC20 ä»£å¸åˆçº¦ MyERC20Tokenã€‚åŸºäº OpenZeppelin æ ‡å‡†åº“ï¼Œåˆçº¦æ”¯æŒé“¸é€ ã€é”€æ¯ã€è®¸å¯ç­‰åŠŸèƒ½ï¼Œå¹¶åœ¨ Sepolia æµ‹è¯•ç½‘ä¸ŠæˆåŠŸä¸Šçº¿ã€‚æˆ‘ä»¬å°†æ·±å…¥å‰–æä»£ç é€»è¾‘ã€éƒ¨ç½²è„šæœ¬åŠé—®é¢˜è§£å†³è¿‡ç¨‹ï¼Œä¸ºä½ æä¾›ä¸€ç«™å¼çš„ Web3 å¼€å‘å®æˆ˜æŒ‡å—ã€‚å‡†å¤‡å¥½åŠ¨æ‰‹æ‰“é€ ä½ çš„ä»£å¸äº†å—ï¼Ÿ

## å®æ“

### åˆçº¦ä»£ç 

```ts
// SPDX-License-Identifier: MIT
// Compatible with OpenZeppelin Contracts ^5.0.0
pragma solidity ^0.8.20;

import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Votes.sol";
import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@openzeppelin/contracts/interfaces/IERC1363Receiver.sol";

// import "erc-payable-token/contracts/token/ERC1363/IERC1363Errors.sol";
import {ERC1363Utils} from "erc-payable-token/contracts/token/ERC1363/ERC1363Utils.sol";

contract MyERC20Token is ERC20, ERC20Burnable, Ownable, ERC20Permit, ERC20Votes {
    constructor(address initialOwner)
        ERC20("MyERC20Token", "MTKERC20")
        Ownable(initialOwner)
        ERC20Permit("MyERC20Token")
    {}

    function mint(address to, uint256 amount) public onlyOwner {
        _mint(to, amount);
    }

    // The following functions are overrides required by Solidity.

    function _update(address from, address to, uint256 value) internal override(ERC20, ERC20Votes) {
        super._update(from, to, value);
    }

    function nonces(address owner) public view override(ERC20Permit, Nonces) returns (uint256) {
        return super.nonces(owner);
    }

    function transferAndcall(address to, uint256 value, bytes calldata data) public returns (bool) {
        if (!transfer(to, value)) {
            revert ERC1363Utils.ERC1363TransferFailed(to, value);
        }

        _checkOnTransferReceived(msg.sender, to, value, data);

        return true;
    }

    function _checkOnTransferReceived(address from, address to, uint256 value, bytes memory data) private {
        if (to.code.length == 0) {
            revert ERC1363Utils.ERC1363EOAReceiver(to);
        }

        try IERC1363Receiver(to).onTransferReceived(_msgSender(), from, value, data) returns (bytes4 retval) {
            if (retval != IERC1363Receiver.onTransferReceived.selector) {
                revert ERC1363Utils.ERC1363InvalidReceiver(to);
            }
        } catch (bytes memory reason) {
            if (reason.length == 0) {
                revert ERC1363Utils.ERC1363InvalidReceiver(to);
            } else {
                assembly {
                    revert(add(32, reason), mload(reason))
                }
            }
        }
    }

    function isContract(address account) internal view returns (bool) {
        uint256 size;
        assembly {
            size := extcodesize(account)
        }
        return size > 0;
    }
}

```

### åˆçº¦ä»£ç è§£æ

ä»¥ä¸‹æ˜¯ MyERC20Token åˆçº¦çš„æ ¸å¿ƒä»£ç ï¼Œæˆ‘ä»¬å°†é€éƒ¨åˆ†æ‹†è§£å®ƒçš„åŠŸèƒ½å’Œå®ç°é€»è¾‘ã€‚

```ts
// SPDX-License-Identifier: MIT
// Compatible with OpenZeppelin Contracts ^5.0.0
pragma solidity ^0.8.20;
```

- // SPDX-License-Identifier: MITï¼šå£°æ˜ä»£ç é‡‡ç”¨ MIT è®¸å¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ã€‚  
- // Compatible with OpenZeppelin Contracts ^5.0.0ï¼šè¡¨æ˜ä»£ç ä¸ OpenZeppelin 5.0.0 ç‰ˆæœ¬å…¼å®¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¹¿å—ä¿¡èµ–çš„æ™ºèƒ½åˆçº¦åº“ã€‚  
- pragma solidity ^0.8.20ï¼šæŒ‡å®š Solidity ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼Œç¡®ä¿ä»£ç åœ¨ 0.8.20 åŠä»¥ä¸Šç‰ˆæœ¬è¿è¡Œï¼Œåˆ©ç”¨å…¶å®‰å…¨æ€§æ”¹è¿›ã€‚

```ts
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Votes.sol";
import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@openzeppelin/contracts/interfaces/IERC1363Receiver.sol";
import {ERC1363Utils} from "erc-payable-token/contracts/token/ERC1363/ERC1363Utils.sol";
```

- è¿™äº› import è¯­å¥å¼•å…¥äº† OpenZeppelin æä¾›çš„æ¨¡å—åŒ–åŠŸèƒ½ï¼š  
  - ERC20ï¼šåŸºç¡€ ERC20 ä»£å¸æ ‡å‡†ï¼Œæä¾›è½¬è´¦ã€ä½™é¢æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚  
  - ERC20Burnableï¼šæ‰©å±•åŠŸèƒ½ï¼Œå…è®¸é”€æ¯ä»£å¸ã€‚  
  - Ownableï¼šè®¿é—®æ§åˆ¶ï¼Œåªæœ‰åˆçº¦æ‹¥æœ‰è€…å¯æ‰§è¡Œç‰¹å®šæ“ä½œã€‚  
  - ERC20Permitï¼šæ”¯æŒç¦»çº¿ç­¾åæˆæƒï¼ˆEIP-2612ï¼‰ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚  
  - ERC20Votesï¼šæ”¯æŒæ²»ç†æŠ•ç¥¨åŠŸèƒ½ï¼Œè®°å½•ä»£å¸æŒæœ‰è€…çš„æŠ•ç¥¨æƒé‡ã€‚  
  - IERC721 å’Œ IERC1363Receiverï¼šä¸ºåç»­æ‰©å±•ï¼ˆå¦‚ä¸ NFT æˆ–æ”¯ä»˜åŠŸèƒ½é›†æˆï¼‰é¢„ç•™æ¥å£ã€‚  
  - ERC1363Utilsï¼šæ”¯æŒ ERC1363 æ ‡å‡†ï¼Œæä¾›ä»£å¸è½¬è´¦åå›è°ƒåŠŸèƒ½ã€‚

```ts
contract MyERC20Token is ERC20, ERC20Burnable, Ownable, ERC20Permit, ERC20Votes {
    constructor(address initialOwner)
        ERC20("MyERC20Token", "MTKERC20")
        Ownable(initialOwner)
        ERC20Permit("MyERC20Token")
    {}
```

- MyERC20Token ç»§æ‰¿äº†å¤šä¸ª OpenZeppelin åˆçº¦ï¼Œé›†æˆäº†åŸºç¡€ä»£å¸ã€é”€æ¯ã€æƒé™ã€ç­¾åå’ŒæŠ•ç¥¨åŠŸèƒ½ã€‚  
- constructorï¼š  
    æ„é€ å‡½æ•° ï¼š
  - åˆå§‹åŒ–ä»£å¸åç§°ä¸º MyERC20Tokenï¼Œç¬¦å·ä¸º MTKERC20ã€‚  
  - å°†åˆçº¦æ‹¥æœ‰è€…è®¾ç½®ä¸º initialOwnerï¼Œåªæœ‰æ­¤åœ°å€èƒ½è°ƒç”¨å—é™å‡½æ•°ï¼ˆå¦‚é“¸é€ ï¼‰ã€‚  
  - ERC20Permit åˆå§‹åŒ–ä»£å¸åç§°ï¼Œæ”¯æŒç­¾åæˆæƒã€‚

```ts
function mint(address to, uint256 amount) public onlyOwner {
    _mint(to, amount);
}
```

- mint å‡½æ•°å…è®¸åˆçº¦æ‹¥æœ‰è€…é“¸é€ æ–°ä»£å¸ã€‚  
- å‚æ•° to æ˜¯æ¥æ”¶è€…åœ°å€ï¼Œamount æ˜¯é“¸é€ æ•°é‡ã€‚  
- onlyOwner ä¿®é¥°ç¬¦é™åˆ¶åªæœ‰æ‹¥æœ‰è€…å¯è°ƒç”¨ï¼Œè°ƒç”¨å†…éƒ¨ _mint å‡½æ•°å¢åŠ ä»£å¸ä¾›åº”ã€‚

```ts
function _update(address from, address to, uint256 value) internal override(ERC20, ERC20Votes) {
    super._update(from, to, value);
}

function nonces(address owner) public view override(ERC20Permit, Nonces) returns (uint256) {
    return super.nonces(owner);
}
```

- è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ç”±äºå¤šé‡ç»§æ‰¿ï¼ˆERC20 å’Œ ERC20Votesã€ERC20Permitï¼‰éœ€è¦é‡å†™çš„ï¼š  
  - _updateï¼šæ›´æ–°ä»£å¸è½¬è´¦çŠ¶æ€ï¼ŒåŒæ—¶è®°å½•æŠ•ç¥¨æƒé‡ã€‚  
  - noncesï¼šè¿”å›æŸåœ°å€çš„ç­¾åè®¡æ•°ï¼Œç”¨äºé˜²æ­¢é‡æ”¾æ”»å‡»ã€‚
- ä½¿ç”¨ super è°ƒç”¨çˆ¶åˆçº¦çš„å®ç°ï¼Œç¡®ä¿åŠŸèƒ½ä¸€è‡´æ€§ã€‚

```ts
function transferAndcall(address to, uint256 value, bytes calldata data) public returns (bool) {
    if (!transfer(to, value)) {
        revert ERC1363Utils.ERC1363TransferFailed(to, value);
    }
    _checkOnTransferReceived(msg.sender, to, value, data);
    return true;
}
```

- transferAndcall å®ç° ERC1363 æ ‡å‡†ï¼Œæ”¯æŒè½¬è´¦åå›è°ƒã€‚  
- å…ˆè°ƒç”¨ transfer æ‰§è¡Œè½¬è´¦ï¼Œè‹¥å¤±è´¥åˆ™æŠ›å‡ºé”™è¯¯ã€‚  
- æˆåŠŸåè°ƒç”¨ _checkOnTransferReceived æ£€æŸ¥æ¥æ”¶è€…æ˜¯å¦æ”¯æŒå›è°ƒã€‚

```ts
function _checkOnTransferReceived(address from, address to, uint256 value, bytes memory data) private {
    if (to.code.length == 0) {
        revert ERC1363Utils.ERC1363EOAReceiver(to);
    }
    try IERC1363Receiver(to).onTransferReceived(_msgSender(), from, value, data) returns (bytes4 retval) {
        if (retval != IERC1363Receiver.onTransferReceived.selector) {
            revert ERC1363Utils.ERC1363InvalidReceiver(to);
        }
    } catch (bytes memory reason) {
        if (reason.length == 0) {
            revert ERC1363Utils.ERC1363InvalidReceiver(to);
        } else {
            assembly {
                revert(add(32, reason), mload(reason))
            }
        }
    }
}
```

- _checkOnTransferReceived éªŒè¯æ¥æ”¶è€…æ˜¯å¦ä¸ºæ”¯æŒ ERC1363 çš„åˆçº¦ï¼š  
  - to.code.length == 0ï¼šæ£€æŸ¥ç›®æ ‡åœ°å€æ˜¯å¦ä¸ºæ™®é€šè´¦æˆ·ï¼ˆEOAï¼‰ï¼Œè‹¥æ˜¯åˆ™æŠ¥é”™ã€‚  
  - try-catchï¼šè°ƒç”¨æ¥æ”¶åˆçº¦çš„ onTransferReceived å‡½æ•°ï¼ŒéªŒè¯è¿”å›å€¼æ˜¯å¦æ­£ç¡®ã€‚  
  - è‹¥å¤±è´¥ï¼ˆè¿”å›å€¼ä¸ç¬¦æˆ–å¼‚å¸¸ï¼‰ï¼ŒæŠ›å‡ºç›¸åº”é”™è¯¯ã€‚

```ts
function isContract(address account) internal view returns (bool) {
    uint256 size;
    assembly {
        size := extcodesize(account)
    }
    return size > 0;
}
```

- isContract æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºåˆçº¦ï¼Œé€šè¿‡æ±‡ç¼–æŒ‡ä»¤ extcodesize è·å–ä»£ç å¤§å°ã€‚  
- è¿”å› true è¡¨ç¤ºæ˜¯åˆçº¦ï¼Œfalse è¡¨ç¤ºæ™®é€šè´¦æˆ·ï¼Œç”¨äºæ”¯æŒ ERC1363 çš„é€»è¾‘ã€‚

------
è¿™æ®µä»£ç å±•ç¤ºäº†ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ ERC20 ä»£å¸åˆçº¦ï¼š  

- **æ ‡å‡†æ€§**ï¼šåŸºäº OpenZeppelinï¼Œç¡®ä¿ä»£ç å®‰å…¨å’Œå…¼å®¹æ€§ã€‚  
- **æ‰©å±•æ€§**ï¼šæ”¯æŒé”€æ¯ã€ç­¾åæˆæƒã€æŠ•ç¥¨å’Œè½¬è´¦å›è°ƒï¼Œæ»¡è¶³å¤šæ ·åŒ–éœ€æ±‚ã€‚  
- **å®‰å…¨æ€§**ï¼šé€šè¿‡ onlyOwner å’Œé”™è¯¯å¤„ç†æœºåˆ¶ä¿æŠ¤åˆçº¦æ“ä½œã€‚

è¿™æ®µä»£ç ä¸ä»…æ˜¯ Web3 å¼€å‘çš„å®æˆ˜èŒƒä¾‹ï¼Œä¹Ÿæ˜¯ç†è§£ Solidity ç»§æ‰¿å’Œæ¥å£æ‰©å±•çš„ç»ä½³æ¡ˆä¾‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•éƒ¨ç½²å®ƒåˆ°æµ‹è¯•ç½‘ï¼ŒçœŸæ­£è®©ä½ çš„ä»£å¸â€œæ´»â€èµ·æ¥ï¼

### éƒ¨ç½²è„šæœ¬

```ts
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import {Script, console} from "forge-std/Script.sol";
import {MyERC20Token} from "../src/MyERC20Token.sol";

contract MyERC20TokenScript is Script {
    MyERC20Token public mytoken;

    function setUp() public {}

    function run() public {
        vm.startBroadcast();

        mytoken = new MyERC20Token(msg.sender);
        console.log("MyERC20Token deployed to:", address(mytoken));

        vm.stopBroadcast();
    }
}

```

## éƒ¨ç½²åˆçº¦

#### æŠ¥é”™è§£å†³

![image-20240717183613976](/images/image-20240717183613976.png)

è§£å†³ï¼š`forge clean`

#### éƒ¨ç½²æˆåŠŸ

```bash
NFTMarketHub on î‚  main [!] via â¬¢ v22.1.0 via ğŸ…’ base took 4.2s
âœ source .env

NFTMarketHub on î‚  main [!] via â¬¢ v22.1.0 via ğŸ…’ base
âœ forge script --chain sepolia script/MyERC20Token.s.sol:MyERC20TokenScript --rpc-url $SEPOLIA_RPC_URL --broadcast --account MetaMask --verify -vvvv

[â Š] Compiling...
No files changed, compilation skipped
Enter keystore password:
Traces:
  [1927821] MyERC20TokenScript::run()
    â”œâ”€ [0] VM::startBroadcast()
    â”‚   â””â”€ â† [Return]
    â”œâ”€ [1881633] â†’ new MyERC20Token@0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1
    â”‚   â”œâ”€ emit OwnershipTransferred(previousOwner: 0x0000000000000000000000000000000000000000, newOwner: DefaultSender: [0x1804c8AB1F12E6bbf3894d4083f33e07309d1f38])
    â”‚   â””â”€ â† [Return] 9047 bytes of code
    â”œâ”€ [0] console::log("MyERC20Token deployed to:", MyERC20Token: [0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1]) [staticcall]
    â”‚   â””â”€ â† [Stop]
    â”œâ”€ [0] VM::stopBroadcast()
    â”‚   â””â”€ â† [Return]
    â””â”€ â† [Stop]


Script ran successfully.

== Logs ==
  MyERC20Token deployed to: 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1

## Setting up 1 EVM.
==========================
Simulated On-chain Traces:

  [1881633] â†’ new MyERC20Token@0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1
    â”œâ”€ emit OwnershipTransferred(previousOwner: 0x0000000000000000000000000000000000000000, newOwner: DefaultSender: [0x1804c8AB1F12E6bbf3894d4083f33e07309d1f38])
    â””â”€ â† [Return] 9047 bytes of code


==========================

Chain 11155111

Estimated gas price: 15.090597416 gwei

Estimated total gas used for script: 2722903

Estimated amount required: 0.041090232975818648 ETH

==========================

##### sepolia
âœ…  [Success]Hash: 0xe8faf9a7c819bd8d4a2f5ca01030d3c420df711731703988b33011b327c2f8f5
Contract Address: 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1
Block: 6326818
Paid: 0.016047232328922354 ETH (2095191 gas * 7.659078494 gwei)

âœ… Sequence #1 on sepolia | Total Paid: 0.016047232328922354 ETH (2095191 gas * avg 7.659078494 gwei)


==========================

ONCHAIN EXECUTION COMPLETE & SUCCESSFUL.
##
Start verification for (1) contracts
Start verifying contract `0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1` deployed on sepolia

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1.

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1.

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1.

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1.

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xd557Bf08136D90ed553b882Eb365e0F6b9728bB1.
Submitted contract for verification:
        Response: `OK`
        GUID: `cwwzeekad22aijh7sqhtlifbz11icmwignhtdf9dcbmdtfczrb`
        URL: https://sepolia.etherscan.io/address/0xd557bf08136d90ed553b882eb365e0f6b9728bb1
Contract verification status:
Response: `NOTOK`
Details: `Pending in queue`
Contract verification status:
Response: `OK`
Details: `Pass - Verified`
Contract successfully verified
All (1) contracts were verified!

Transactions saved to: /Users/qiaopengjun/Code/solidity-code/NFTMarketHub/broadcast/MyERC20Token.s.sol/11155111/run-latest.json

Sensitive values saved to: /Users/qiaopengjun/Code/solidity-code/NFTMarketHub/cache/MyERC20Token.s.sol/11155111/run-latest.json


```

<https://sepolia.etherscan.io/address/0xd557bf08136d90ed553b882eb365e0f6b9728bb1>

![image-20240717184431297](/images/image-20240717184431297.png)

### éƒ¨ç½²é—®é¢˜ä¿®æ”¹

```bash
NFTMarketHub on î‚  main [!?] via â¬¢ v22.1.0 via ğŸ…’ base took 1m 26.6s
âœ source .env

NFTMarketHub on î‚  main [!?] via â¬¢ v22.1.0 via ğŸ…’ base
âœ forge script --chain sepolia MyERC20TokenScript --rpc-url $SEPOLIA_RPC_URL --broadcast --verify -vvvv
[â Š] Compiling...
[â ”] Compiling 1 files with Solc 0.8.20
[â ’] Solc 0.8.20 finished in 1.44s
Compiler run successful!
Traces:
  [2355225] â†’ new MyERC20TokenScript@0x5b73C5498c1E3b4dbA84de0F1833c4a029d90519
    â””â”€ â† [Return] 11653 bytes of code

  [98] MyERC20TokenScript::setUp()
    â””â”€ â† [Stop]

  [2950] MyERC20TokenScript::run()
    â”œâ”€ [0] VM::envUint("PRIVATE_KEY") [staticcall]
    â”‚   â””â”€ â† [Revert] failed parsing $PRIVATE_KEY as type `uint256`: missing hex prefix ("0x") for hex string
    â””â”€ â† [Revert] failed parsing $PRIVATE_KEY as type `uint256`: missing hex prefix ("0x") for hex string


Error:
script failed: failed parsing $PRIVATE_KEY as type `uint256`: missing hex prefix ("0x") for hex string

NFTMarketHub on î‚  main [!?] via â¬¢ v22.1.0 via ğŸ…’ base took 11.7s
âœ forge script --chain sepolia MyERC20TokenScript --rpc-url $SEPOLIA_RPC_URL --broadcast --verify -vvvv

[â Š] Compiling...
No files changed, compilation skipped
Traces:
  [1929276] MyERC20TokenScript::run()
    â”œâ”€ [0] VM::envUint("PRIVATE_KEY") [staticcall]
    â”‚   â””â”€ â† [Return] <env var value>
    â”œâ”€ [0] VM::envAddress("ACCOUNT_ADDRESS") [staticcall]
    â”‚   â””â”€ â† [Return] <env var value>
    â”œâ”€ [0] VM::startBroadcast(<pk>)
    â”‚   â””â”€ â† [Return]
    â”œâ”€ [1881633] â†’ new MyERC20Token@0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa
    â”‚   â”œâ”€ emit OwnershipTransferred(previousOwner: 0x0000000000000000000000000000000000000000, newOwner: 0x750Ea21c1e98CcED0d4557196B6f4a5974CCB6f5)
    â”‚   â””â”€ â† [Return] 9047 bytes of code
    â”œâ”€ [0] console::log("deployerAccountAddress :", 0x750Ea21c1e98CcED0d4557196B6f4a5974CCB6f5) [staticcall]
    â”‚   â””â”€ â† [Stop]
    â”œâ”€ [0] console::log("MyERC20Token deployed to:", MyERC20Token: [0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa]) [staticcall]
    â”‚   â””â”€ â† [Stop]
    â”œâ”€ [0] VM::stopBroadcast()
    â”‚   â””â”€ â† [Return]
    â””â”€ â† [Stop]


Script ran successfully.

== Logs ==
  deployerAccountAddress : 0x750Ea21c1e98CcED0d4557196B6f4a5974CCB6f5
  MyERC20Token deployed to: 0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa

## Setting up 1 EVM.
==========================
Simulated On-chain Traces:

  [1881633] â†’ new MyERC20Token@0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa
    â”œâ”€ emit OwnershipTransferred(previousOwner: 0x0000000000000000000000000000000000000000, newOwner: 0x750Ea21c1e98CcED0d4557196B6f4a5974CCB6f5)
    â””â”€ â† [Return] 9047 bytes of code


==========================

Chain 11155111

Estimated gas price: 31.484721969 gwei

Estimated total gas used for script: 2722903

Estimated amount required: 0.085729843903556007 ETH

==========================

##### sepolia
âœ…  [Success]Hash: 0x6981a969928123236332cf8a1ccab58c202ccb1e056d4f99daca8d2b881749f0
Contract Address: 0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa
Block: 6355495
Paid: 0.032185872758241342 ETH (2095191 gas * 15.361784562 gwei)

âœ… Sequence #1 on sepolia | Total Paid: 0.032185872758241342 ETH (2095191 gas * avg 15.361784562 gwei)


==========================

ONCHAIN EXECUTION COMPLETE & SUCCESSFUL.
##
Start verification for (1) contracts
Start verifying contract `0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa` deployed on sepolia

Submitting verification for [src/MyERC20Token.sol:MyERC20Token] 0xc32cE2198B123D1c1F7FD3A9f54Bff9f975819Fa.
Submitted contract for verification:
        Response: `OK`
        GUID: `nrfj275cavnnxjapk9jy8xl7qudvynqn7vkashvfkv2kkfzws7`
        URL: https://sepolia.etherscan.io/address/0xc32ce2198b123d1c1f7fd3a9f54bff9f975819fa
Contract verification status:
Response: `NOTOK`
Details: `Pending in queue`
Contract verification status:
Response: `OK`
Details: `Pass - Verified`
Contract successfully verified
All (1) contracts were verified!

Transactions saved to: /Users/qiaopengjun/Code/solidity-code/NFTMarketHub/broadcast/MyERC20Token.s.sol/11155111/run-latest.json

Sensitive values saved to: /Users/qiaopengjun/Code/solidity-code/NFTMarketHub/cache/MyERC20Token.s.sol/11155111/run-latest.json


NFTMarketHub on î‚  main [!?] via â¬¢ v22.1.0 via ğŸ…’ base took 48.0s
âœ
```

<https://sepolia.etherscan.io/address/0xc32ce2198b123d1c1f7fd3a9f54bff9f975819fa#code>

![image-20240722175318903](/images/image-20240722175318903.png)

## æ€»ç»“

è¿™åœº Web3 å®æˆ˜ä¹‹æ—…ï¼Œæˆ‘ä»¬ä»é›¶æ­å»ºå¹¶éƒ¨ç½²äº†ä¸€ä¸ªç¬¦åˆ ERC20 æ ‡å‡†çš„ä»£å¸åˆçº¦ï¼ŒéªŒè¯äº†å…¶åœ¨æµ‹è¯•ç½‘ä¸Šçš„å¯è¡Œæ€§ã€‚è¿™ä¸ä»…æ˜¯ä¸€æ¬¡ä»£ç çš„å®è·µï¼Œæ›´æ˜¯å¯¹ Web3 å»ä¸­å¿ƒåŒ–æ½œåŠ›çš„æ·±åº¦ä½“éªŒã€‚æ— è®ºä½ æ˜¯æƒ³å‘è¡Œè‡ªå·±çš„ä»£å¸ï¼Œè¿˜æ˜¯æ¢ç´¢åŒºå—é“¾å¼€å‘çš„å¥¥ç§˜ï¼Œæœ¬æ–‡éƒ½ä¸ºä½ æ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚æ¥ä¸‹æ¥ï¼Œä¸å¦¨å°è¯•ä¼˜åŒ–åˆçº¦åŠŸèƒ½ï¼Œæˆ–å°†åˆ›æ„å˜ä¸ºç°å®â€”â€”ä½ çš„ Web3 å†’é™©æ‰åˆšåˆšå¼€å§‹ï¼

## å‚è€ƒ

- <https://sepolia.etherscan.io/address/0xc32ce2198b123d1c1f7fd3a9f54bff9f975819fa#code>
- <https://learnblockchain.cn/docs/solidity/>
- <https://solidity-by-example.org/>
- <https://remix.ethereum.org/#lang=en&optimize=false&runs=200&evmVersion=null&version=soljson-v0.8.18+commit.87f61d96.js>
- <https://etherscan.io/>
- <https://book.getfoundry.sh/>
