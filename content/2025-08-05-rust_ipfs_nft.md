+++
title = "Rust x IPFSï¼šä»å‘½ä»¤è¡Œåˆ°å®˜æ–¹åº“ï¼Œç²¾é€šNFTå…ƒæ•°æ®ä¸Šä¼ "
description = "Rust x IPFSï¼šä»å‘½ä»¤è¡Œåˆ°å®˜æ–¹åº“ï¼Œç²¾é€šNFTå…ƒæ•°æ®ä¸Šä¼ "
date = 2025-08-05T02:59:17Z
[taxonomies]
categories = ["Rust", "IPFS", "NFT"]
tags = ["Rust", "IPFS", "NFT"]
+++

<!-- more -->

# Rust x IPFSï¼šä»å‘½ä»¤è¡Œåˆ°å®˜æ–¹åº“ï¼Œç²¾é€šNFTå…ƒæ•°æ®ä¸Šä¼ 

ç»§æˆ‘ä»¬å…ˆå‰åœ¨ã€ŠNFT å¼€å‘æ ¸å¿ƒæ­¥éª¤ï¼šæœ¬åœ° IPFS èŠ‚ç‚¹æ­å»ºä¸å…ƒæ•°æ®ä¸Šä¼ å®æˆ˜ã€‹ã€ã€ŠPython x IPFSï¼šæ„å»ºç”Ÿäº§çº§çš„ NFT å…ƒæ•°æ®è‡ªåŠ¨åŒ–æµç¨‹ã€‹ã€ã€Šä»å‘½ä»¤è¡Œåˆ°å®˜æ–¹åº“ï¼šç”¨ Go è¯­è¨€ç²¾é€š NFT å…ƒæ•°æ® IPFS ä¸Šä¼ ã€‹ä¸­åˆ†åˆ«ä½¿ç”¨ TypeScriptã€Python å’Œ Go æˆåŠŸå®ç°å…ƒæ•°æ®è‡ªåŠ¨åŒ–ä¸Šä¼ åï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†è¿æ¥æ–°çš„ç¯‡ç« â€”â€”ä½¿ç”¨æ€§èƒ½å“è¶Šä¸”å®‰å…¨å¯é çš„ Rust è¯­è¨€æ¥å®Œæˆè¿™ä¸€æ ¸å¿ƒä»»åŠ¡ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ä¸¤ç§æˆªç„¶ä¸åŒçš„å®ç°è·¯å¾„ï¼šä¸€ç§æ˜¯ç›´æ¥é€šè¿‡è°ƒç”¨ `ipfs` å‘½ä»¤è¡Œå·¥å…·çš„å¿«æ·æ–¹å¼ï¼Œå¦ä¸€ç§æ˜¯é‡‡ç”¨å®˜æ–¹ `ipfs-api-backend-hyper` åº“è¿›è¡ŒåŸç”Ÿé›†æˆçš„ä¸“ä¸šæ–¹å¼ã€‚æˆ‘ä»¬å°†é€šè¿‡è¯¦ç»†çš„å®æˆ˜ä»£ç ï¼Œåˆ†åˆ«å¤„ç†å•ä¸ª NFT å’Œæ‰¹é‡ NFT é›†åˆè¿™ä¸¤ç§å…³é”®åœºæ™¯ï¼Œæœ€ç»ˆå‘ˆç°ä¸€ä¸ªç»è¿‡ç²¾å¿ƒé‡æ„å’Œä¼˜åŒ–çš„ç”Ÿäº§çº§è§£å†³æ–¹æ¡ˆã€‚

æœ¬å®æˆ˜æ•™ç¨‹æ¼”ç¤ºäº†å¦‚ä½•ç”¨ Rust å°† NFT å…ƒæ•°æ®é«˜æ•ˆä¸Šä¼ è‡³ IPFSã€‚æ–‡ç« æ ¸å¿ƒåœ¨äºå¯¹æ¯”äº†ä¸¤ç§å®ç°è·¯å¾„ï¼šç›´æ¥è°ƒç”¨ IPFS å‘½ä»¤è¡Œï¼Œä»¥åŠé€šè¿‡å®˜æ–¹ ipfs-api-backend-hyper åº“è¿›è¡ŒåŸç”Ÿé›†æˆã€‚æ•™ç¨‹å®Œæ•´è¦†ç›–äº†å•ä¸ªåŠæ‰¹é‡ NFT çš„å¤„ç†å·¥ä½œæµï¼Œå¹¶é€šè¿‡ä»£ç é‡æ„ï¼Œæœ€ç»ˆæä¾›äº†ä¸€ä¸ªæ¨¡å—åŒ–ã€é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ Web3 å¼€å‘æ–¹æ¡ˆã€‚

## å®æ“

IPFS çš„ä¸¤ç§ä¸åŒä½¿ç”¨åœºæ™¯ï¼š

- å¯¹äºå•ä¸ª NFTï¼Œé“¾æ¥ç›´æ¥æŒ‡å‘æ–‡ä»¶å†…å®¹ CIDï¼Œä¸å¸¦æ–‡ä»¶åæˆ–åç¼€ã€‚
- å¯¹äºæ‰¹é‡é›†åˆä¸­çš„ NFTï¼Œé“¾æ¥æŒ‡å‘æ–‡ä»¶å¤¹ CID ä¸‹çš„å…·ä½“æ–‡ä»¶åã€‚

### æŸ¥çœ‹é¡¹ç›®ç›®å½•

```bash
polyglot-ipfs-uploader/rust on î‚  main is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ tree . -L 6 -I "migrations|mochawesome-report|.anchor|docs|target|node_modules"
.
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ examples
â”‚   â”œâ”€â”€ cli_uploader.rs
â”‚   â””â”€â”€ library_uploader.rs
â””â”€â”€ src
    â”œâ”€â”€ lib.rs
    â””â”€â”€ main.rs

3 directories, 6 files
```

### `Cargo.toml` æ–‡ä»¶

```rust
[package]
name = "rust"
version = "0.1.0"
edition = "2024"

[[example]]
name = "cli_uploader"
path = "examples/cli_uploader.rs"

[[example]]
name = "library_uploader"
path = "examples/library_uploader.rs"


[dependencies]
anyhow = "1.0.98"
chrono = "0.4.41"
futures = "0.3.31"
ipfs-api-backend-hyper = "0.6.0"
serde = { version = "1.0.219", features = ["derive"] }
serde_json = "1.0.141"
tokio = { version = "1.47.0", features = ["full"] }
walkdir = "2.5.0"

```

### `src/main.rs` æ–‡ä»¶

```rust
use anyhow::{Result, anyhow};
use chrono::Utc;
use serde::{Deserialize, Serialize};
use std::fs::{self, File};
use std::io::{self, Write};
use std::path::{Path, PathBuf};
use std::process::{Command, Stdio};
use walkdir::WalkDir;

// âœ… é…ç½®å¼€å…³
const USE_JSON_SUFFIX: bool = false;

// âœ… å®šä¹‰å…ƒæ•°æ®ç»“æ„ä½“
#[derive(Serialize, Deserialize)]
struct Attribute {
    trait_type: String,
    value: serde_json::Value,
}

#[derive(Serialize, Deserialize)]
struct NftMetadata {
    name: String,
    description: String,
    image: String,
    attributes: Vec<Attribute>,
}

// æ ¸å¿ƒä¸Šä¼ å‡½æ•° (ä½¿ç”¨ std::process::Command)
fn upload_to_ipfs(target_path: &Path) -> Result<String> {
    if !target_path.exists() {
        return Err(anyhow!("âŒ è·¯å¾„ä¸å­˜åœ¨: {:?}", target_path));
    }

    let path_str = target_path
        .to_str()
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„"))?;
    println!(
        "\n--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 {} ---",
        path_str
    );

    let output = Command::new("ipfs")
        .arg("add")
        .arg("-r") // é€’å½’ä¸Šä¼ 
        .arg("-Q") // åªè¾“å‡ºæ ¹ CID
        .arg("--cid-version")
        .arg("1")
        .arg(path_str)
        .output()?;

    if !output.status.success() {
        return Err(anyhow!(
            "âŒ ä¸Šä¼ å¤±è´¥: {}",
            String::from_utf8_lossy(&output.stderr)
        ));
    }

    let cid = String::from_utf8(output.stdout)?.trim().to_string();
    println!("âœ… ä¸Šä¼ æˆåŠŸ!");
    println!(
        "   - åç§°: {}",
        target_path.file_name().unwrap().to_str().unwrap()
    );
    println!("   - CID: {}", cid);
    Ok(cid)
}

// ä¸Šä¼  JSON æ•°æ®çš„ä¸“ç”¨å‡½æ•°
fn upload_json_str_to_ipfs(data: &NftMetadata) -> Result<String> {
    println!("\n--- æ­£åœ¨ä¸Šä¼  JSON å¯¹è±¡ ---");
    let json_string = serde_json::to_string(data)?;

    let mut child = Command::new("ipfs")
        .arg("add")
        .arg("-Q")
        .arg("--cid-version")
        .arg("1")
        .stdin(Stdio::piped())
        .stdout(Stdio::piped())
        .stderr(Stdio::piped())
        .spawn()?;

    // å°† JSON å­—ç¬¦ä¸²å†™å…¥å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥
    if let Some(mut stdin) = child.stdin.take() {
        stdin.write_all(json_string.as_bytes())?;
    }

    let output = child.wait_with_output()?;
    if !output.status.success() {
        return Err(anyhow!(
            "âŒ ä¸Šä¼  JSON å¤±è´¥: {}",
            String::from_utf8_lossy(&output.stderr)
        ));
    }

    let cid = String::from_utf8(output.stdout)?.trim().to_string();
    println!("âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ!\n   - CID: {}", cid);
    Ok(cid)
}

// å·¥ä½œæµä¸€ï¼šå¤„ç†å•ä¸ª NFT
fn process_single_nft(image_path: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT...");
    println!(
        "   - æ–‡ä»¶åç¼€æ¨¡å¼: {}",
        if USE_JSON_SUFFIX { ".json" } else { "æ— " }
    );
    println!("==============================================");

    let image_cid = upload_to_ipfs(image_path)?;
    println!("\nğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: {}", image_cid);

    let image_filename = image_path
        .file_name()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;
    let image_name_without_ext = image_path
        .file_stem()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;

    let metadata = NftMetadata {
        name: image_name_without_ext.to_string(),
        description: format!("è¿™æ˜¯ä¸€ä¸ªä¸ºå›¾ç‰‡ {} åŠ¨æ€ç”Ÿæˆçš„å…ƒæ•°æ®ã€‚", image_filename),
        image: format!("ipfs://{}", image_cid),
        attributes: vec![Attribute {
            trait_type: "ç±»å‹".to_string(),
            value: serde_json::Value::String("å•ä»¶è‰ºæœ¯å“".to_string()),
        }],
    };

    let metadata_cid = upload_json_str_to_ipfs(&metadata)?;

    let output_dir = PathBuf::from("output").join(image_name_without_ext);
    fs::create_dir_all(&output_dir)?;
    fs::copy(image_path, output_dir.join(image_filename))?;

    let file_name = if USE_JSON_SUFFIX {
        format!("{}.json", image_name_without_ext)
    } else {
        image_name_without_ext.to_string()
    };
    let mut metadata_file = File::create(output_dir.join(file_name))?;
    let pretty_json = serde_json::to_string_pretty(&metadata)?;
    metadata_file.write_all(pretty_json.as_bytes())?;

    println!("\nğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: {:?}", output_dir);
    println!("\n--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://{}",
        metadata_cid
    );
    Ok(())
}

// å·¥ä½œæµäºŒï¼šå¤„ç†æ‰¹é‡ NFT é›†åˆ
fn process_batch_collection(images_input_dir: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ...");
    println!(
        "   - æ–‡ä»¶åç¼€æ¨¡å¼: {}",
        if USE_JSON_SUFFIX { ".json" } else { "æ— " }
    );
    println!("==============================================");

    let images_folder_cid = upload_to_ipfs(images_input_dir)?;
    println!("\nğŸ–¼ï¸  å›¾ç‰‡æ–‡ä»¶å¤¹ CID å·²è·å–: {}", images_folder_cid);

    let timestamp = Utc::now().format("%Y%m%d_%H%M%S").to_string();
    let collection_output_dir = PathBuf::from("output").join(format!("collection_{}", timestamp));
    let images_output_dir = collection_output_dir.join("images");
    let metadata_output_dir = collection_output_dir.join("metadata");

    copy_directory(images_input_dir, &images_output_dir)?;
    println!("\nğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: {:?}", images_output_dir);

    println!("\n--- æ­£åœ¨ä¸ºæ¯å¼ å›¾ç‰‡ç”Ÿæˆå…ƒæ•°æ® JSON æ–‡ä»¶ ---");
    fs::create_dir_all(&metadata_output_dir)?;

    let mut image_files: Vec<PathBuf> = fs::read_dir(images_input_dir)?
        .filter_map(Result::ok)
        .map(|entry| entry.path())
        .filter(|path| path.is_file())
        .collect();
    image_files.sort();

    for image_file in &image_files {
        let token_id_str = image_file
            .file_stem()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆçš„æ–‡ä»¶å"))?;
        let token_id: u64 = token_id_str.parse()?;
        let image_filename = image_file
            .file_name()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆçš„æ–‡ä»¶å"))?;

        let metadata = NftMetadata {
            name: format!("MetaCore #{}", token_id),
            description: "MetaCore é›†åˆä¸­çš„ä¸€ä¸ªç‹¬ç‰¹æˆå‘˜ã€‚".to_string(),
            image: format!("ipfs://{}/{}", images_folder_cid, image_filename),
            attributes: vec![Attribute {
                trait_type: "ID".to_string(),
                value: serde_json::Value::Number(token_id.into()),
            }],
        };
        let file_name = if USE_JSON_SUFFIX {
            format!("{}.json", token_id_str)
        } else {
            token_id_str.to_string()
        };
        let mut file = File::create(metadata_output_dir.join(file_name))?;
        let pretty_json = serde_json::to_string_pretty(&metadata)?;
        file.write_all(pretty_json.as_bytes())?;
    }
    println!(
        "âœ… æˆåŠŸç”Ÿæˆ {} ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: {:?}",
        image_files.len(),
        metadata_output_dir
    );

    let metadata_folder_cid = upload_to_ipfs(&metadata_output_dir)?;
    println!("\nğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: {}", metadata_folder_cid);
    println!("\n--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://{}/",
        metadata_folder_cid
    );
    Ok(())
}

fn main() -> Result<()> {
    // å‰ç½®æ£€æŸ¥
    let status = Command::new("ipfs").arg("id").output()?.status;
    if !status.success() {
        eprintln!("âŒ è¿æ¥ IPFS èŠ‚ç‚¹å¤±è´¥ã€‚");
        eprintln!("è¯·ç¡®ä¿ä½ çš„ IPFS èŠ‚ç‚¹æ­£åœ¨è¿è¡Œ (å‘½ä»¤: ipfs daemon)ã€‚");
        return Err(anyhow!("IPFS daemon not running"));
    }
    println!("âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹");

    let single_image_path = PathBuf::from("../assets/image/IMG_20210626_180340.jpg");
    let batch_images_path = PathBuf::from("../assets/batch_images");
    fs::create_dir_all(&batch_images_path)?;

    // --- åœ¨è¿™é‡Œé€‰æ‹©è¦è¿è¡Œçš„å·¥ä½œæµ ---
    process_single_nft(&single_image_path)?;
    process_batch_collection(&batch_images_path)?;

    println!("\n======================================================================");
    println!("âœ… æœ¬åœ°å‡†å¤‡å·¥ä½œå·²å®Œæˆï¼");
    println!("ä¸‹ä¸€æ­¥æ˜¯å‘å¸ƒåˆ°ä¸“ä¸šçš„ Pinning æœåŠ¡ (å¦‚ Pinata):");
    println!("1. ç™»å½• Pinataã€‚");
    println!("2. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/images` æ–‡ä»¶å¤¹ã€‚");
    println!("3. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/metadata` æ–‡ä»¶å¤¹ã€‚");
    println!("4. âš ï¸  ä½¿ç”¨ Pinata è¿”å›çš„ã€metadataã€‘æ–‡ä»¶å¤¹çš„ CID æ¥è®¾ç½®æ‚¨åˆçº¦çš„ Base URIã€‚");
    println!("======================================================================");

    Ok(())
}

// --- è¾…åŠ©å‡½æ•° ---
fn copy_directory(src: &Path, dst: &Path) -> io::Result<()> {
    fs::create_dir_all(dst)?;
    for entry in WalkDir::new(src) {
        let entry = entry?;
        let path = entry.path();
        let relative_path = path.strip_prefix(src).unwrap();
        let dest_path = dst.join(relative_path);
        if path.is_dir() {
            fs::create_dir_all(&dest_path)?;
        } else {
            fs::copy(path, &dest_path)?;
        }
    }
    Ok(())
}

```

### ç¼–è¯‘æ„å»º

```bash
polyglot-ipfs-uploader/rust on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo build
warning: function `upload_json_str_to_ipfs` is never used
  --> src/main.rs:69:4
   |
69 | fn upload_json_str_to_ipfs(data: &NftMetadata) -> Result<String> {
   |    ^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: function `process_single_nft` is never used
   --> src/main.rs:102:4
    |
102 | fn process_single_nft(image_path: &Path) -> Result<()> {
    |    ^^^^^^^^^^^^^^^^^^

warning: `rust` (bin "rust") generated 2 warnings
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.14s
```

### æµ‹è¯•æ‰¹é‡ NFT é›†åˆä¸”Metadataæ–‡ä»¶åç¼€æ¨¡å¼: .json

```bash
polyglot-ipfs-uploader/rust on î‚  main [!] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run
warning: function `upload_json_str_to_ipfs` is never used
  --> src/main.rs:69:4
   |
69 | fn upload_json_str_to_ipfs(data: &NftMetadata) -> Result<String> {
   |    ^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: function `process_single_nft` is never used
   --> src/main.rs:102:4
    |
102 | fn process_single_nft(image_path: &Path) -> Result<()> {
    |    ^^^^^^^^^^^^^^^^^^

warning: `rust` (bin "rust") generated 2 warnings
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.19s
     Running `target/debug/rust`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ...
   - æ–‡ä»¶åç¼€æ¨¡å¼: .json
==============================================

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 ../assets/batch_images ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: batch_images
   - CID: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ–¼ï¸  å›¾ç‰‡æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_20250728_092506/images"

--- æ­£åœ¨ä¸ºæ¯å¼ å›¾ç‰‡ç”Ÿæˆå…ƒæ•°æ® JSON æ–‡ä»¶ ---
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_20250728_092506/metadata"

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 output/collection_20250728_092506/metadata ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: metadata
   - CID: bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4/

======================================================================
âœ… æœ¬åœ°å‡†å¤‡å·¥ä½œå·²å®Œæˆï¼
ä¸‹ä¸€æ­¥æ˜¯å‘å¸ƒåˆ°ä¸“ä¸šçš„ Pinning æœåŠ¡ (å¦‚ Pinata):
1. ç™»å½• Pinataã€‚
2. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/images` æ–‡ä»¶å¤¹ã€‚
3. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/metadata` æ–‡ä»¶å¤¹ã€‚
4. âš ï¸  ä½¿ç”¨ Pinata è¿”å›çš„ã€metadataã€‘æ–‡ä»¶å¤¹çš„ CID æ¥è®¾ç½®æ‚¨åˆçº¦çš„ Base URIã€‚
======================================================================

```

### æµ‹è¯•å•ä¸ªNFTä¸”Metadataæ–‡ä»¶åç¼€æ¨¡å¼: .json

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
warning: function `process_batch_collection` is never used
   --> src/main.rs:158:4
    |
158 | fn process_batch_collection(images_input_dir: &Path) -> Result<()> {
    |    ^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` on by default

warning: function `copy_directory` is never used
   --> src/main.rs:264:4
    |
264 | fn copy_directory(src: &Path, dst: &Path) -> io::Result<()> {
    |    ^^^^^^^^^^^^^^

warning: `rust` (bin "rust") generated 2 warnings
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 1.04s
     Running `target/debug/rust`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT...
   - æ–‡ä»¶åç¼€æ¨¡å¼: .json
==============================================

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 ../assets/image/IMG_20210626_180340.jpg ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: IMG_20210626_180340.jpg
   - CID: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

--- æ­£åœ¨ä¸Šä¼  JSON å¯¹è±¡ ---
âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ!
   - CID: bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

======================================================================
âœ… æœ¬åœ°å‡†å¤‡å·¥ä½œå·²å®Œæˆï¼
ä¸‹ä¸€æ­¥æ˜¯å‘å¸ƒåˆ°ä¸“ä¸šçš„ Pinning æœåŠ¡ (å¦‚ Pinata):
1. ç™»å½• Pinataã€‚
2. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/images` æ–‡ä»¶å¤¹ã€‚
3. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/metadata` æ–‡ä»¶å¤¹ã€‚
4. âš ï¸  ä½¿ç”¨ Pinata è¿”å›çš„ã€metadataã€‘æ–‡ä»¶å¤¹çš„ CID æ¥è®¾ç½®æ‚¨åˆçº¦çš„ Base URIã€‚
======================================================================
```

### æµ‹è¯•å•ä¸ª NFTä¸”Metadataæ–‡ä»¶æ— åç¼€æ¨¡å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
warning: function `process_batch_collection` is never used
   --> src/main.rs:158:4
    |
158 | fn process_batch_collection(images_input_dir: &Path) -> Result<()> {
    |    ^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` on by default

warning: function `copy_directory` is never used
   --> src/main.rs:264:4
    |
264 | fn copy_directory(src: &Path, dst: &Path) -> io::Result<()> {
    |    ^^^^^^^^^^^^^^

warning: `rust` (bin "rust") generated 2 warnings
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.57s
     Running `target/debug/rust`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT...
   - æ–‡ä»¶åç¼€æ¨¡å¼: æ— 
==============================================

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 ../assets/image/IMG_20210626_180340.jpg ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: IMG_20210626_180340.jpg
   - CID: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

--- æ­£åœ¨ä¸Šä¼  JSON å¯¹è±¡ ---
âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ!
   - CID: bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

======================================================================
âœ… æœ¬åœ°å‡†å¤‡å·¥ä½œå·²å®Œæˆï¼
ä¸‹ä¸€æ­¥æ˜¯å‘å¸ƒåˆ°ä¸“ä¸šçš„ Pinning æœåŠ¡ (å¦‚ Pinata):
1. ç™»å½• Pinataã€‚
2. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/images` æ–‡ä»¶å¤¹ã€‚
3. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/metadata` æ–‡ä»¶å¤¹ã€‚
4. âš ï¸  ä½¿ç”¨ Pinata è¿”å›çš„ã€metadataã€‘æ–‡ä»¶å¤¹çš„ CID æ¥è®¾ç½®æ‚¨åˆçº¦çš„ Base URIã€‚
======================================================================
```

### æµ‹è¯•æ‰¹é‡ NFT é›†åˆä¸”Metadataæ–‡ä»¶æ— åç¼€æ¨¡å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
warning: function `upload_json_str_to_ipfs` is never used
  --> src/main.rs:69:4
   |
69 | fn upload_json_str_to_ipfs(data: &NftMetadata) -> Result<String> {
   |    ^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: function `process_single_nft` is never used
   --> src/main.rs:102:4
    |
102 | fn process_single_nft(image_path: &Path) -> Result<()> {
    |    ^^^^^^^^^^^^^^^^^^

warning: `rust` (bin "rust") generated 2 warnings
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.67s
     Running `target/debug/rust`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ...
   - æ–‡ä»¶åç¼€æ¨¡å¼: æ— 
==============================================

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 ../assets/batch_images ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: batch_images
   - CID: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ–¼ï¸  å›¾ç‰‡æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_20250728_092723/images"

--- æ­£åœ¨ä¸ºæ¯å¼ å›¾ç‰‡ç”Ÿæˆå…ƒæ•°æ® JSON æ–‡ä»¶ ---
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_20250728_092723/metadata"

--- æ­£åœ¨æ‰§è¡Œä¸Šä¼ å‘½ä»¤: ipfs add -r -Q --cid-version 1 output/collection_20250728_092723/metadata ---
âœ… ä¸Šä¼ æˆåŠŸ!
   - åç§°: metadata
   - CID: bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq/

======================================================================
âœ… æœ¬åœ°å‡†å¤‡å·¥ä½œå·²å®Œæˆï¼
ä¸‹ä¸€æ­¥æ˜¯å‘å¸ƒåˆ°ä¸“ä¸šçš„ Pinning æœåŠ¡ (å¦‚ Pinata):
1. ç™»å½• Pinataã€‚
2. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/images` æ–‡ä»¶å¤¹ã€‚
3. ä¸Šä¼ æ‚¨æœ¬åœ° `rust/output/collection_[æ—¶é—´æˆ³]/metadata` æ–‡ä»¶å¤¹ã€‚
4. âš ï¸  ä½¿ç”¨ Pinata è¿”å›çš„ã€metadataã€‘æ–‡ä»¶å¤¹çš„ CID æ¥è®¾ç½®æ‚¨åˆçº¦çš„ Base URIã€‚
======================================================================

```

å› ä¸ºæˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­é€šè¿‡æ³¨é‡Šæ¥é€‰æ‹©æ‰§è¡Œå•ä¸ªæˆ–æ‰¹é‡æµç¨‹ï¼Œæ‰€ä»¥æœªè¢«è°ƒç”¨çš„å‡½æ•°ä¼šæ”¶åˆ°ç¼–è¯‘å™¨è­¦å‘Šï¼Œè¿™åœ¨å¼€å‘æµ‹è¯•é˜¶æ®µæ˜¯æ­£å¸¸ç°è±¡ã€‚

## é‡æ„ä¼˜åŒ–å®Œå–„ä¸¤ç§å®ç°è·¯å¾„

### èµ°å‘ç”Ÿäº§ï¼šé¡¹ç›®ç»“æ„åŒ–é‡æ„

### `src/lib.rs` æ–‡ä»¶

```rust
use std::{fs, path::Path};

use anyhow::Result;
use serde::{Deserialize, Serialize};
use walkdir::WalkDir;

// âœ… å®šä¹‰å…ƒæ•°æ®ç»“æ„ä½“
#[derive(Serialize, Deserialize, Debug)]
pub struct Attribute {
    pub trait_type: String,
    pub value: serde_json::Value,
}

#[derive(Serialize, Deserialize, Debug)]
pub struct NftMetadata {
    pub name: String,
    pub description: String,
    pub image: String,
    pub attributes: Vec<Attribute>,
}

// âœ… å…±äº«çš„è¾…åŠ©å‡½æ•°
pub fn copy_directory(src: &Path, dst: &Path) -> Result<()> {
    fs::create_dir_all(dst)?;
    for entry in WalkDir::new(src) {
        let entry = entry?;
        let path = entry.path();
        let relative_path = path.strip_prefix(src)?;
        let dest_path = dst.join(relative_path);
        if path.is_dir() {
            fs::create_dir_all(&dest_path)?;
        } else {
            fs::copy(path, &dest_path)?;
        }
    }
    Ok(())
}

```

### è·¯å¾„ä¸€ï¼šåŸºäºå‘½ä»¤è¡Œçš„å¿«é€Ÿå®ç° (`std::process::Command`)

### `examples/cli_uploader.rs` æ–‡ä»¶

```rust
// examples/cli_uploader.rs

use anyhow::{Result, anyhow};
use chrono::Utc;
use rust::{Attribute, NftMetadata, copy_directory};
use std::fs::{self, File};
use std::io::Write;
use std::path::{Path, PathBuf};
use std::process::{Command, Stdio};

const USE_JSON_SUFFIX: bool = false;

// --- æ ¸å¿ƒä¸Šä¼ å‡½æ•° ---
fn upload_to_ipfs(target_path: &Path) -> Result<String> {
    if !target_path.exists() {
        return Err(anyhow!("è·¯å¾„ä¸å­˜åœ¨: {:?}", target_path));
    }
    let path_str = target_path.to_str().ok_or_else(|| anyhow!("æ— æ•ˆè·¯å¾„"))?;
    println!(
        "\n--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 {} ---",
        path_str
    );
    let output = Command::new("ipfs")
        .args(["add", "-r", "-Q", "--cid-version", "1", path_str])
        .output()?;
    if !output.status.success() {
        return Err(anyhow!(
            "ä¸Šä¼ å¤±è´¥: {}",
            String::from_utf8_lossy(&output.stderr)
        ));
    }
    let cid = String::from_utf8(output.stdout)?.trim().to_string();
    println!("âœ… ä¸Šä¼ æˆåŠŸ! CID: {}", cid);
    Ok(cid)
}

fn upload_json_str_to_ipfs(data: &NftMetadata) -> Result<String> {
    let json_string = serde_json::to_string(data)?;
    let mut child = Command::new("ipfs")
        .args(["add", "-Q", "--cid-version", "1"])
        .stdin(Stdio::piped())
        .stdout(Stdio::piped())
        .spawn()?;
    if let Some(mut stdin) = child.stdin.take() {
        stdin.write_all(json_string.as_bytes())?;
    }
    let output = child.wait_with_output()?;
    if !output.status.success() {
        return Err(anyhow!(
            "ä¸Šä¼ JSONå¤±è´¥: {}",
            String::from_utf8_lossy(&output.stderr)
        ));
    }
    let cid = String::from_utf8(output.stdout)?.trim().to_string();
    println!("\nâœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: {}", cid);
    Ok(cid)
}

// --- å·¥ä½œæµä¸€ï¼šå¤„ç†å•ä¸ª NFT ---
fn process_single_nft(image_path: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å‘½ä»¤è¡Œæ–¹å¼)...");
    println!("==============================================");

    let image_cid = upload_to_ipfs(image_path)?;
    println!("\nğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: {}", image_cid);

    let image_filename = image_path
        .file_name()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;
    let image_name_without_ext = image_path
        .file_stem()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;

    let metadata = NftMetadata {
        name: image_name_without_ext.to_string(),
        description: format!("è¿™æ˜¯ä¸€ä¸ªä¸ºå›¾ç‰‡ {} åŠ¨æ€ç”Ÿæˆçš„å…ƒæ•°æ®ã€‚", image_filename),
        image: format!("ipfs://{}", image_cid),
        attributes: vec![Attribute {
            trait_type: "ç±»å‹".to_string(),
            value: serde_json::Value::String("å•ä»¶è‰ºæœ¯å“".to_string()),
        }],
    };

    let metadata_cid = upload_json_str_to_ipfs(&metadata)?;

    let output_dir = PathBuf::from("output").join(image_name_without_ext);
    fs::create_dir_all(&output_dir)?;
    fs::copy(image_path, output_dir.join(image_filename))?;

    let file_name = if USE_JSON_SUFFIX {
        format!("{}.json", image_name_without_ext)
    } else {
        image_name_without_ext.to_string()
    };
    let mut metadata_file = File::create(output_dir.join(file_name))?;
    let pretty_json = serde_json::to_string_pretty(&metadata)?;
    metadata_file.write_all(pretty_json.as_bytes())?;

    println!("\nğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: {:?}", output_dir);
    println!("\n--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://{}",
        metadata_cid
    );
    Ok(())
}

// --- å·¥ä½œæµäºŒï¼šå¤„ç†æ‰¹é‡ NFT é›†åˆ ---
fn process_batch_collection(images_input_dir: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å‘½ä»¤è¡Œæ–¹å¼)...");
    println!("==============================================");
    let images_folder_cid = upload_to_ipfs(images_input_dir)?;
    let timestamp = Utc::now().format("%Y%m%d_%H%M%S").to_string();
    let collection_output_dir =
        PathBuf::from("output").join(format!("collection_cli_{}", timestamp));
    let images_output_dir = collection_output_dir.join("images");
    let metadata_output_dir = collection_output_dir.join("metadata");
    copy_directory(images_input_dir, &images_output_dir)?;
    println!("\nğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: {:?}", images_output_dir);
    fs::create_dir_all(&metadata_output_dir)?;
    let mut image_files: Vec<PathBuf> = fs::read_dir(images_input_dir)?
        .filter_map(Result::ok)
        .map(|e| e.path())
        .filter(|p| p.is_file())
        .collect();
    image_files.sort();
    for image_file in &image_files {
        let token_id_str = image_file
            .file_stem()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆæ–‡ä»¶å"))?;
        let token_id: u64 = token_id_str.parse()?;
        let image_filename = image_file
            .file_name()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆæ–‡ä»¶å"))?;
        let metadata = NftMetadata {
            name: format!("MetaCore #{}", token_id),
            description: "MetaCore é›†åˆä¸­çš„ä¸€ä¸ªç‹¬ç‰¹æˆå‘˜ã€‚".to_string(),
            image: format!("ipfs://{}/{}", images_folder_cid, image_filename),
            attributes: vec![Attribute {
                trait_type: "ID".to_string(),
                value: token_id.into(),
            }],
        };
        let file_name = if USE_JSON_SUFFIX {
            format!("{}.json", token_id_str)
        } else {
            token_id_str.to_string()
        };
        let mut file = File::create(metadata_output_dir.join(file_name))?;
        file.write_all(serde_json::to_string_pretty(&metadata)?.as_bytes())?;
    }
    println!(
        "âœ… æˆåŠŸç”Ÿæˆ {} ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: {:?}",
        image_files.len(),
        metadata_output_dir
    );
    let metadata_folder_cid = upload_to_ipfs(&metadata_output_dir)?;
    println!("\nğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: {}", metadata_folder_cid);
    println!("\n--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://{}/",
        metadata_folder_cid
    );
    Ok(())
}

fn main() -> Result<()> {
    let status = Command::new("ipfs").arg("id").output()?.status;
    if !status.success() {
        return Err(anyhow!("è¿æ¥ IPFS èŠ‚ç‚¹å¤±è´¥ã€‚è¯·ç¡®ä¿ ipfs daemon æ­£åœ¨è¿è¡Œã€‚"));
    }
    println!("âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹");

    // âœ… å®šä¹‰äº†ä¸¤ä¸ªè·¯å¾„ï¼Œå¹¶å…è®¸ç”¨æˆ·é€‰æ‹©
    let single_image_path = PathBuf::from("../assets/image/IMG_20210626_180340.jpg");
    let batch_images_path = PathBuf::from("../assets/batch_images");
    fs::create_dir_all(&batch_images_path)?;

    // --- åœ¨è¿™é‡Œé€‰æ‹©è¦è¿è¡Œçš„å·¥ä½œæµ ---
    process_single_nft(&single_image_path)?;
    process_batch_collection(&batch_images_path)?;

    Ok(())
}

```

### æµ‹è¯•Metadataæ–‡ä»¶ä¸ºJSONåç¼€æ¨¡å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run --example cli_uploader
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.97s
     Running `target/debug/examples/cli_uploader`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å‘½ä»¤è¡Œæ–¹å¼)...
==============================================

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 ../assets/image/IMG_20210626_180340.jpg ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å‘½ä»¤è¡Œæ–¹å¼)...
==============================================

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 ../assets/batch_images ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_cli_20250728_113659/images"
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_cli_20250728_113659/metadata"

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 output/collection_cli_20250728_113659/metadata ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://bafybeiguvcmspmkhyheyh5c7wmixuiiysjpcrw4hjvvydmfhqmwsopvjk4/

```

### æµ‹è¯•Metadataæ–‡ä»¶æ— åç¼€æ¨¡å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run --example cli_uploader
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.86s
     Running `target/debug/examples/cli_uploader`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å‘½ä»¤è¡Œæ–¹å¼)...
==============================================

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 ../assets/image/IMG_20210626_180340.jpg ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: bafybeifwvvo7qacd5ksephyxbqkqjih2dmm2ffgqa6u732b2evw5iijppi

âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://bafkreihhpbkssgrr22r3f3rhrb4hntmbdzfm3ubaun2cfw4p5vyhcgivbi

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å‘½ä»¤è¡Œæ–¹å¼)...
==============================================

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 ../assets/batch_images ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeia22ed2lhakgwu76ojojhuavlxkccpclciy6hgqsmn6o7ur7cw44e

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_cli_20250728_113814/images"
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_cli_20250728_113814/metadata"

--- æ­£åœ¨æ‰§è¡Œ(å‘½ä»¤è¡Œ): ipfs add -r -Q --cid-version 1 output/collection_cli_20250728_113814/metadata ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://bafybeihnyl6zp4q4xusvpt77nzl7ljg3ec6xhbgaflzrn6bzrpo7nivgzq/

```

### è·¯å¾„äºŒï¼šåŸºäºå®˜æ–¹åº“çš„ä¸“ä¸šå®ç° (`ipfs-api-backend-hyper`)

### `examples/library_uploader.rs` æ–‡ä»¶

```rust
// examples/library_uploader.rs

use rust::{Attribute, NftMetadata, copy_directory};

use anyhow::{Result, anyhow};
use chrono::Utc;
use ipfs_api_backend_hyper::{IpfsApi, IpfsClient, TryFromUri};
use std::fs::{self, File};
use std::io::{Cursor, Write};
use std::path::{Path, PathBuf};

const USE_JSON_SUFFIX: bool = false;
const IPFS_API_URL: &str = "http://localhost:5001";

// --- æ ¸å¿ƒä¸Šä¼ å‡½æ•° ---

// ä¸Šä¼ å•ä¸ªæ–‡ä»¶
async fn upload_file_to_ipfs(client: &IpfsClient, target_path: &Path) -> Result<String> {
    println!("\n--- æ­£åœ¨ä¸Šä¼ (åº“): {:?} ---", target_path);
    if !target_path.exists() {
        return Err(anyhow!("è·¯å¾„ä¸å­˜åœ¨: {:?}", target_path));
    }
    let data = fs::read(target_path)?;
    let cursor = Cursor::new(data);
    let res = client.add(cursor).await?;
    let cid = res.hash;
    println!("âœ… ä¸Šä¼ æˆåŠŸ! CID: {}", cid);
    Ok(cid)
}

// ä¸Šä¼ æ•´ä¸ªæ–‡ä»¶å¤¹
async fn upload_directory_to_ipfs(client: &IpfsClient, dir_path: &Path) -> Result<String> {
    println!("\n--- æ­£åœ¨ä¸Šä¼ æ–‡ä»¶å¤¹(åº“): {:?} ---", dir_path);
    // add_path è¿”å›ä¸€ä¸ª Vecï¼Œæœ€åä¸€ä¸ªå…ƒç´ æ˜¯æ ¹ç›®å½•çš„ä¿¡æ¯
    let responses = client.add_path(dir_path).await?;
    if let Some(root_res) = responses.last() {
        let cid = root_res.hash.clone();
        println!("âœ… æ–‡ä»¶å¤¹ä¸Šä¼ æˆåŠŸ! CID: {}", cid);
        Ok(cid)
    } else {
        Err(anyhow!("æ–‡ä»¶å¤¹ä¸Šä¼ å¤±è´¥"))
    }
}

// ä¸Šä¼  JSON æ•°æ®
async fn upload_json_str_to_ipfs(client: &IpfsClient, data: &NftMetadata) -> Result<String> {
    let json_string = serde_json::to_string(data)?;
    let cursor = Cursor::new(json_string.into_bytes());
    let res = client.add(cursor).await?;
    let cid = res.hash;
    println!("\nâœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: {}", cid);
    Ok(cid)
}

// --- å·¥ä½œæµä¸€ï¼šå¤„ç†å•ä¸ª NFT ---
async fn process_single_nft(client: &IpfsClient, image_path: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å®˜æ–¹åº“æ–¹å¼)...");
    println!("==============================================");

    let image_cid = upload_file_to_ipfs(client, image_path).await?;
    println!("\nğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: {}", image_cid);

    let image_filename = image_path
        .file_name()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;
    let image_name_without_ext = image_path
        .file_stem()
        .and_then(|s| s.to_str())
        .ok_or_else(|| anyhow!("æ— æ•ˆçš„å›¾ç‰‡æ–‡ä»¶å"))?;

    let metadata = NftMetadata {
        name: image_name_without_ext.to_string(),
        description: format!("è¿™æ˜¯ä¸€ä¸ªä¸ºå›¾ç‰‡ {} åŠ¨æ€ç”Ÿæˆçš„å…ƒæ•°æ®ã€‚", image_filename),
        image: format!("ipfs://{}", image_cid),
        attributes: vec![Attribute {
            trait_type: "ç±»å‹".to_string(),
            value: serde_json::Value::String("å•ä»¶è‰ºæœ¯å“".to_string()),
        }],
    };

    let metadata_cid = upload_json_str_to_ipfs(client, &metadata).await?;

    let output_dir = PathBuf::from("output").join(image_name_without_ext);
    fs::create_dir_all(&output_dir)?;
    fs::copy(image_path, output_dir.join(image_filename))?;

    let file_name = if USE_JSON_SUFFIX {
        format!("{}.json", image_name_without_ext)
    } else {
        image_name_without_ext.to_string()
    };
    let mut metadata_file = File::create(output_dir.join(file_name))?;
    let pretty_json = serde_json::to_string_pretty(&metadata)?;
    metadata_file.write_all(pretty_json.as_bytes())?;

    println!("\nğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: {:?}", output_dir);
    println!("\n--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://{}",
        metadata_cid
    );
    Ok(())
}

// --- å·¥ä½œæµäºŒï¼šå¤„ç†æ‰¹é‡ NFT é›†åˆ ---
async fn process_batch_collection(client: &IpfsClient, images_input_dir: &Path) -> Result<()> {
    println!("\n==============================================");
    println!("ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å®˜æ–¹åº“æ–¹å¼)...");
    println!("==============================================");
    let images_folder_cid = upload_directory_to_ipfs(client, images_input_dir).await?;
    let timestamp = Utc::now().format("%Y%m%d_%H%M%S").to_string();
    let collection_output_dir =
        PathBuf::from("output").join(format!("collection_lib_{}", timestamp));
    let images_output_dir = collection_output_dir.join("images");
    let metadata_output_dir = collection_output_dir.join("metadata");
    copy_directory(images_input_dir, &images_output_dir)?;
    println!("\nğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: {:?}", images_output_dir);
    fs::create_dir_all(&metadata_output_dir)?;
    let mut image_files: Vec<PathBuf> = fs::read_dir(images_input_dir)?
        .filter_map(Result::ok)
        .map(|e| e.path())
        .filter(|p| p.is_file())
        .collect();
    image_files.sort();
    for image_file in &image_files {
        let token_id_str = image_file
            .file_stem()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆæ–‡ä»¶å"))?;
        let token_id: u64 = token_id_str.parse()?;
        let image_filename = image_file
            .file_name()
            .and_then(|s| s.to_str())
            .ok_or_else(|| anyhow!("æ— æ•ˆæ–‡ä»¶å"))?;
        let metadata = NftMetadata {
            name: format!("MetaCore #{}", token_id),
            description: "MetaCore é›†åˆä¸­çš„ä¸€ä¸ªç‹¬ç‰¹æˆå‘˜ã€‚".to_string(),
            image: format!("ipfs://{}/{}", images_folder_cid, image_filename),
            attributes: vec![Attribute {
                trait_type: "ID".to_string(),
                value: token_id.into(),
            }],
        };
        let file_name = if USE_JSON_SUFFIX {
            format!("{}.json", token_id_str)
        } else {
            token_id_str.to_string()
        };
        let mut file = File::create(metadata_output_dir.join(file_name))?;
        file.write_all(serde_json::to_string_pretty(&metadata)?.as_bytes())?;
    }
    println!(
        "âœ… æˆåŠŸç”Ÿæˆ {} ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: {:?}",
        image_files.len(),
        metadata_output_dir
    );
    let metadata_folder_cid = upload_directory_to_ipfs(client, &metadata_output_dir).await?;
    println!("\nğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: {}", metadata_folder_cid);
    println!("\n--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---");
    println!(
        "ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://{}/",
        metadata_folder_cid
    );
    Ok(())
}

#[tokio::main]
async fn main() -> Result<()> {
    let client = IpfsClient::from_multiaddr_str(IPFS_API_URL)
        .map_err(|e| anyhow!("åˆ›å»º IPFS å®¢æˆ·ç«¯å¤±è´¥: {}", e))?;

    if client.version().await.is_err() {
        eprintln!("âŒ è¿æ¥ IPFS èŠ‚ç‚¹å¤±è´¥ã€‚è¯·ç¡®ä¿ ipfs daemon æ­£åœ¨è¿è¡Œã€‚");
        return Ok(());
    }
    println!("âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹");

    let single_image_path = PathBuf::from("../assets/image/IMG_20210626_180340.jpg");
    let batch_images_path = PathBuf::from("../assets/batch_images");
    fs::create_dir_all(&batch_images_path)?;

    // --- åœ¨è¿™é‡Œé€‰æ‹©è¦è¿è¡Œçš„å·¥ä½œæµ ---
    // é¦–å…ˆè¿è¡Œå·¥ä½œæµä¸€ï¼šå¤„ç†å•ä¸ª NFT
    process_single_nft(&client, &single_image_path).await?;
    // ç„¶åè¿è¡Œå·¥ä½œæµäºŒï¼šå¤„ç†æ‰¹é‡ NFT é›†åˆ
    process_batch_collection(&client, &batch_images_path).await?;

    Ok(())
}

```

### æµ‹è¯•Metadataæ–‡ä»¶JSONåç¼€æ–¹å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack)
âœ cargo run --example library_uploader
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 2.95s
     Running `target/debug/examples/library_uploader`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å®˜æ–¹åº“æ–¹å¼)...
==============================================

--- æ­£åœ¨ä¸Šä¼ (åº“): "../assets/image/IMG_20210626_180340.jpg" ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: QmXgwL18mcPFTJvbLmGXet4rpGwU9oNH9bDRGYuV1vNtQs

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: QmXgwL18mcPFTJvbLmGXet4rpGwU9oNH9bDRGYuV1vNtQs

âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: QmZj3odMubignuppJo93wBiNVDv1U1HbYRCmQcQQ8VS4rd

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://QmZj3odMubignuppJo93wBiNVDv1U1HbYRCmQcQQ8VS4rd

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å®˜æ–¹åº“æ–¹å¼)...
==============================================

--- æ­£åœ¨ä¸Šä¼ æ–‡ä»¶å¤¹(åº“): "../assets/batch_images" ---
âœ… æ–‡ä»¶å¤¹ä¸Šä¼ æˆåŠŸ! CID: QmVKhPv53d3WKZi5if4Tm4sZnYEL9t2n7kD4v7ENMqx8WP

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_lib_20250728_114023/images"
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_lib_20250728_114023/metadata"

--- æ­£åœ¨ä¸Šä¼ æ–‡ä»¶å¤¹(åº“): "output/collection_lib_20250728_114023/metadata" ---
âœ… æ–‡ä»¶å¤¹ä¸Šä¼ æˆåŠŸ! CID: QmcZtafg6yiSzNaNsjyyh2ttHYbekbBVGubJnANPhHXwQM

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: QmcZtafg6yiSzNaNsjyyh2ttHYbekbBVGubJnANPhHXwQM

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://QmcZtafg6yiSzNaNsjyyh2ttHYbekbBVGubJnANPhHXwQM/

```

### æµ‹è¯•Metadataæ–‡ä»¶æ— åç¼€æ–¹å¼

```bash
polyglot-ipfs-uploader/rust on î‚  main [!?] is ğŸ“¦ 0.1.0 via ğŸ¦€ 1.88.0 on ğŸ³ v28.2.2 (orbstack) took 4.1s
âœ cargo run --example library_uploader
   Compiling rust v0.1.0 (/Users/qiaopengjun/Code/Solidity/YuanqiGenesis/polyglot-ipfs-uploader/rust)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 1.25s
     Running `target/debug/examples/library_uploader`
âœ… æˆåŠŸè¿æ¥åˆ° IPFS èŠ‚ç‚¹

==============================================
ğŸš€ å¼€å§‹å¤„ç†å•ä¸ª NFT (å®˜æ–¹åº“æ–¹å¼)...
==============================================

--- æ­£åœ¨ä¸Šä¼ (åº“): "../assets/image/IMG_20210626_180340.jpg" ---
âœ… ä¸Šä¼ æˆåŠŸ! CID: QmXgwL18mcPFTJvbLmGXet4rpGwU9oNH9bDRGYuV1vNtQs

ğŸ–¼ï¸  å›¾ç‰‡ CID å·²è·å–: QmXgwL18mcPFTJvbLmGXet4rpGwU9oNH9bDRGYuV1vNtQs

âœ… JSON å…ƒæ•°æ®ä¸Šä¼ æˆåŠŸ! CID: QmZj3odMubignuppJo93wBiNVDv1U1HbYRCmQcQQ8VS4rd

ğŸ’¾ å›¾ç‰‡å’Œå…ƒæ•°æ®å·²åœ¨æœ¬åœ°æ‰“åŒ…ä¿å­˜è‡³: "output/IMG_20210626_180340"

--- âœ¨ å•ä»¶æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨ mint å‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå…ƒæ•°æ® URI: ipfs://QmZj3odMubignuppJo93wBiNVDv1U1HbYRCmQcQQ8VS4rd

==============================================
ğŸš€ å¼€å§‹å¤„ç†æ‰¹é‡ NFT é›†åˆ (å®˜æ–¹åº“æ–¹å¼)...
==============================================

--- æ­£åœ¨ä¸Šä¼ æ–‡ä»¶å¤¹(åº“): "../assets/batch_images" ---
âœ… æ–‡ä»¶å¤¹ä¸Šä¼ æˆåŠŸ! CID: QmVKhPv53d3WKZi5if4Tm4sZnYEL9t2n7kD4v7ENMqx8WP

ğŸ’¾ æ‰€æœ‰å›¾ç‰‡å·²å¤åˆ¶åˆ°: "output/collection_lib_20250728_114130/images"
âœ… æˆåŠŸç”Ÿæˆ 3 ä¸ªå…ƒæ•°æ®æ–‡ä»¶åˆ°: "output/collection_lib_20250728_114130/metadata"

--- æ­£åœ¨ä¸Šä¼ æ–‡ä»¶å¤¹(åº“): "output/collection_lib_20250728_114130/metadata" ---
âœ… æ–‡ä»¶å¤¹ä¸Šä¼ æˆåŠŸ! CID: QmYcgHTuFBkwv3HRyxmjFmUBPZSwtt3LzFV4kZuCxX5Ti5

ğŸ“„ å…ƒæ•°æ®æ–‡ä»¶å¤¹ CID å·²è·å–: QmYcgHTuFBkwv3HRyxmjFmUBPZSwtt3LzFV4kZuCxX5Ti5

--- âœ¨ æ‰¹é‡æµç¨‹å®Œæˆ âœ¨ ---
ä¸‹ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥åœ¨åˆçº¦ä¸­å°† Base URI è®¾ç½®ä¸º: ipfs://QmYcgHTuFBkwv3HRyxmjFmUBPZSwtt3LzFV4kZuCxX5Ti5/

```

## æ€»ç»“

æœ¬æ–‡æˆåŠŸæ¼”ç¤ºäº†å¦‚ä½•è¿ç”¨ Rust è¯­è¨€ä¸º Web3 é¡¹ç›®æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ NFT å…ƒæ•°æ® IPFS ä¸Šä¼ å™¨ã€‚æˆ‘ä»¬ä»ä¸€ä¸ªåŸºç¡€è„šæœ¬å‡ºå‘ï¼Œé€æ­¥è¿­ä»£ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€ä¸ªç»“æ„æ¸…æ™°ã€ä»£ç å¥å£®çš„è§£å†³æ–¹æ¡ˆã€‚

ä¸»è¦æˆæœåŒ…æ‹¬ï¼š

1. **ä¸¤ç§å®ç°è·¯å¾„**ï¼šæˆ‘ä»¬æ·±å…¥æ¢ç´¢å¹¶å®ç°äº†ä¸¤ç§ä¸»æµçš„ IPFS äº¤äº’æ–¹æ³•ï¼š
   - **å‘½ä»¤è¡Œæ¥å£ (`std::process::Command`)**ï¼šæ­¤æ–¹æ³•ç®€å•ç›´æ¥ï¼Œæ˜“äºå¿«é€Ÿå®ç°ï¼Œéå¸¸é€‚åˆç®€å•çš„è„šæœ¬æˆ–å½“é¡¹ç›®å·²ç»ä¾èµ–äºæœ¬åœ° IPFS å®¢æˆ·ç«¯æ—¶ä½¿ç”¨ã€‚
   - **å®˜æ–¹ Rust åº“ (`ipfs-api-backend-hyper`)**ï¼šæ­¤æ–¹æ³•æ›´ä¸ºä¸“ä¸šå’Œå¥å£®ï¼Œæä¾›äº†ç±»å‹å®‰å…¨ã€å¼‚æ­¥æ”¯æŒå’Œæ›´ä½³çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ˜¯æ„å»ºå¤æ‚ã€é«˜æ€§èƒ½åº”ç”¨ç¨‹åºçš„é¦–é€‰ã€‚
2. **ä¸¤ç§æ ¸å¿ƒå·¥ä½œæµ**ï¼šæˆ‘ä»¬å…¨é¢è¦†ç›–äº† NFT é¡¹ç›®ä¸­æœ€å¸¸è§çš„ä¸¤ç§éœ€æ±‚åœºæ™¯â€”â€”å¤„ç†å•ä¸ª NFT å’Œæ‰¹é‡å¤„ç†æ•´ä¸ª NFT é›†åˆï¼Œå¹¶ä¸ºæ¯ç§åœºæ™¯æä¾›äº†æ˜ç¡®çš„é€»è¾‘å’Œä»£ç å®ç°ã€‚
3. **ä»£ç é‡æ„ä¸ä¼˜åŒ–**ï¼šé€šè¿‡å°†æ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚å…ƒæ•°æ®ç»“æ„ä½“ã€è¾…åŠ©å‡½æ•°ï¼‰æå–åˆ°å…±äº«åº“ `lib.rs` ä¸­ï¼Œå¹¶ä½¿ç”¨ `examples` ç›®å½•æ¥åˆ†ç¦»ä¸åŒçš„å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬æ˜¾è‘—æå‡äº†ä»£ç çš„æ¨¡å—åŒ–ã€å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ— è®ºæ‚¨æ˜¯å€¾å‘äºå¿«é€ŸåŸå‹å¼€å‘çš„ç®€æ´æ€§ï¼Œè¿˜æ˜¯è¿½æ±‚ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šä¸é«˜æ•ˆï¼Œæœ¬æ–‡éƒ½æä¾›äº†ç›¸åº”çš„ Rust å®ç°æ–¹æ¡ˆï¼Œä¸ºæ‚¨çš„ NFT å’Œ Web3 å¼€å‘ä¹‹æ—…æä¾›äº†åšå®çš„æŠ€æœ¯æ”¯æŒã€‚

## å‚è€ƒ

- <https://ipfs.io/>
- <https://app.pinata.cloud/ipfs/files>
- <https://docs.rs/ipfs-api-backend-hyper/0.6.0/ipfs_api_backend_hyper/>

## æ¨èé˜…è¯»

- ã€ŠNFT å¼€å‘æ ¸å¿ƒæ­¥éª¤ï¼šæœ¬åœ° IPFS èŠ‚ç‚¹æ­å»ºä¸å…ƒæ•°æ®ä¸Šä¼ å®æˆ˜ã€‹
- ã€ŠPython x IPFSï¼šæ„å»ºç”Ÿäº§çº§çš„ NFT å…ƒæ•°æ®è‡ªåŠ¨åŒ–æµç¨‹ã€‹
- ã€Šä»å‘½ä»¤è¡Œåˆ°å®˜æ–¹åº“ï¼šç”¨ Go è¯­è¨€ç²¾é€š NFT å…ƒæ•°æ® IPFS ä¸Šä¼ ã€‹
